<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alançš„è‡ªé©±è¿›åŒ–è®¡åˆ’</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
            position: relative;
        }

        .points-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { transform: scale(1); box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 8px 25px rgba(245, 87, 108, 0.6); }
        }

        .points-badge .points-number {
            font-size: 24px;
            margin: 0 5px;
        }

        h1 {
            color: #667eea;
            font-size: 36px;
            margin-bottom: 10px;
        }

        .date-info {
            color: #666;
            font-size: 18px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #495057;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 24px;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
        }

        .input-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-small {
            padding: 6px 15px;
            font-size: 14px;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }

        .card.completed {
            opacity: 0.7;
            border-left-color: #28a745;
            background: #d4edda;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .category-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: 8px;
            vertical-align: middle;
        }

        .card-content {
            color: #666;
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .book-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .book-info {
            flex: 1;
        }

        .book-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .book-progress {
            font-size: 14px;
            color: #666;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        /* ç•ªèŒ„é’Ÿæ ·å¼ */
        .pomodoro-container {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
        }

        .pomodoro-timer {
            font-size: 72px;
            font-weight: bold;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .pomodoro-status {
            font-size: 20px;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .pomodoro-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .pomodoro-btn {
            padding: 12px 30px;
            border: 2px solid white;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pomodoro-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .pomodoro-btn.active {
            background: white;
            color: #ff6b6b;
        }

        .pomodoro-stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            font-size: 14px;
        }

        /* ç§¯åˆ†å…‘æ¢æ ·å¼ */
        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .reward-card {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .reward-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(252, 182, 159, 0.5);
            border-color: #f5576c;
        }

        .reward-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .reward-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .reward-cost {
            font-size: 24px;
            color: #f5576c;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .reward-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .reward-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .reward-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .points-history {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #28a745;
        }

        .history-item.negative {
            border-left-color: #dc3545;
        }

        .history-points {
            font-size: 20px;
            font-weight: bold;
        }

        .history-points.positive {
            color: #28a745;
        }

        .history-points.negative {
            color: #dc3545;
        }

        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            margin: 5px;
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ä½œæ¯è¡¨æ ·å¼ */
        .schedule-container {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .schedule-list {
            display: grid;
            gap: 10px;
        }

        .schedule-item {
            display: flex;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            transition: all 0.3s;
            border-left: 4px solid #667eea;
        }

        .schedule-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .schedule-item.completed {
            opacity: 0.6;
            border-left-color: #28a745;
            background: #f0f0f0;
        }

        .schedule-time {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            min-width: 100px;
            margin-right: 15px;
        }

        .schedule-activity {
            flex: 1;
            font-size: 16px;
            color: #333;
        }

        .schedule-actions {
            display: flex;
            gap: 8px;
        }

        .schedule-check {
            width: 24px;
            height: 24px;
            border: 2px solid #667eea;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .schedule-check:hover {
            background: #e7f1ff;
        }

        .schedule-check.checked {
            background: #28a745;
            border-color: #28a745;
        }

        .schedule-check.checked::after {
            content: 'âœ“';
            color: white;
            font-weight: bold;
        }

        .schedule-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .schedule-input-row input {
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
        }

        .schedule-input-row input[type="time"] {
            width: 120px;
        }

        .schedule-input-row input[type="text"] {
            flex: 1;
            min-width: 200px;
        }

        /* æ¢ç´¢ä¸–ç•Œæ ·å¼ */
        .world-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            color: white;
            margin-bottom: 30px;
        }

        .china-map {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
            min-height: 400px;
            backdrop-filter: blur(10px);
        }

        .map-title {
            text-align: center;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .cities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .city-card {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .city-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .city-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .city-card.unlocked {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .city-card.unlocked::before {
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
        }

        .city-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .city-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .city-desc {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .city-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .city-status.locked {
            background: #e9ecef;
            color: #999;
        }

        .city-status.unlocked {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        /* åŸå¸‚å¡ç‰‡ - å·²è®¿é—®çŠ¶æ€ */
        .city-card.visited {
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }

        /* å»è¿‡æ ‡è®°æŒ‰é’® */
        .visit-toggle-btn {
            margin-top: 10px;
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(135deg, #e0e0e0 0%, #bdbdbd 100%);
            color: #666;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .visit-toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .visit-toggle-btn.visited {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }

        /* åŸå¸‚å¡ç‰‡æŒ‰é’®å®¹å™¨ */
        .city-card-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 12px;
        }

        /* æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® */
        .city-detail-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .city-detail-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
        }

        /* åŸå¸‚è¯¦æƒ…å¼¹çª— */
        .city-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .city-detail-content {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .city-detail-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0,0,0,0.1);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 1;
        }

        .city-detail-close:hover {
            background: rgba(0,0,0,0.2);
            transform: rotate(90deg);
        }

        .city-detail-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            border-radius: 20px 20px 0 0;
            position: relative;
        }

        .city-detail-icon {
            font-size: 64px;
            display: block;
            margin-bottom: 10px;
        }

        .city-detail-header h2 {
            font-size: 28px;
            margin: 0;
        }

        .city-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            margin: 5px 2px;
            font-weight: bold;
        }

        .city-badge.unlocked-badge {
            background: rgba(255,255,255,0.3);
        }

        .city-badge.visited-badge {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
        }

        .city-badge.not-visited-badge {
            background: rgba(255,255,255,0.2);
        }

        .city-badge.locked-badge {
            background: rgba(0,0,0,0.3);
        }

        .city-detail-body {
            padding: 25px;
            color: #333;
            line-height: 1.8;
        }

        .city-detail-footer {
            padding: 20px;
            text-align: center;
            border-top: 1px solid #eee;
        }

        .visit-action-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transition: all 0.3s;
        }

        .visit-action-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .visit-action-btn.visited {
            background: linear-gradient(135deg, #e0e0e0 0%, #bdbdbd 100%);
            color: #666;
        }

        .unlock-hint-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: default;
            background: linear-gradient(135deg, #ffd54f 0%, #ff9800 100%);
            color: white;
            font-weight: bold;
        }

        .travel-stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .travel-stat {
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            min-width: 150px;
        }

        .travel-stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .travel-stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* æµ‹è¯•æ¿å—æ ·å¼ */
        .test-container {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .test-subjects {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .subject-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: #fa709a;
        }

        .subject-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .subject-name {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .subject-desc {
            font-size: 14px;
            color: #666;
        }

        .test-history {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .test-record {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .test-record.excellent {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .test-record.good {
            border-left-color: #ffc107;
            background: #fff3cd;
        }

        .test-record.poor {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .test-score {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .test-score.excellent {
            color: #28a745;
        }

        .test-score.good {
            color: #ffc107;
        }

        .test-score.poor {
            color: #dc3545;
        }

        .test-form {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .test-form input,
        .test-form textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .test-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .test-stat-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .test-stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #fa709a;
            margin-bottom: 5px;
        }

        .test-stat-label {
            font-size: 14px;
            color: #666;
        }

        /* è¿åŠ¨æå‡æ ·å¼ */
        .sports-container {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .sports-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .sport-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .sport-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .sport-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #43e97b;
        }

        .sport-icon-large {
            font-size: 48px;
            margin-right: 15px;
        }

        .sport-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .sport-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .sport-stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .sport-stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #43e97b;
            margin-bottom: 5px;
        }

        .sport-stat-label {
            font-size: 12px;
            color: #666;
        }

        .training-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .training-form input,
        .training-form select,
        .training-form textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .training-records {
            margin-top: 20px;
        }

        .training-record-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #43e97b;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .training-record-item:hover {
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .training-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        /* å®¶åŠ¡åŠ³åŠ¨æ ·å¼ */
        .chores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .chore-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chore-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .chore-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .chore-name {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .chore-points {
            color: #f5576c;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .chore-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .chore-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(67, 233, 123, 0.4);
        }

        .chore-btn:active {
            transform: scale(0.95);
        }

        .chore-records-section {
            padding: 0 20px 20px;
        }

        .chore-records {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .chore-record-item {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #43e97b;
        }

        .chore-record-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chore-record-name {
            font-size: 16px;
            font-weight: bold;
            color: white;
        }

        .chore-record-time {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .chore-record-points {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }

        .sports-overview {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement-item {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .achievement-item:hover {
            transform: scale(1.05);
        }

        .achievement-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .achievement-name {
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš€ Alançš„è‡ªé©±è¿›åŒ–è®¡åˆ’</h1>
            <div class="date-info" id="dateInfo"></div>
            <div class="points-badge">
                â­ <span class="points-number" id="headerPoints">0</span> ç§¯åˆ†
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('dashboard')">ğŸ“Š æ€»è§ˆ</button>
            <button class="tab-btn" onclick="switchTab('homework')">ğŸ“ ä½œä¸šç®¡ç†</button>
            <button class="tab-btn" onclick="switchTab('reading')">ğŸ“– é˜…è¯»ç®¡ç†</button>
            <button class="tab-btn" onclick="switchTab('plan')">ğŸ“… å­¦ä¹ è®¡åˆ’</button>
            <button class="tab-btn" onclick="switchTab('test')">ğŸ“‹ å­¦ä¹ æµ‹è¯•</button>
            <button class="tab-btn" onclick="switchTab('sports')">ğŸ¸ è¿åŠ¨æå‡</button>
            <button class="tab-btn" onclick="switchTab('chores')">ğŸ§¹ å®¶åŠ¡åŠ³åŠ¨</button>
            <button class="tab-btn" onclick="switchTab('rewards')">ğŸ ç§¯åˆ†å…‘æ¢</button>
            <button class="tab-btn" onclick="switchTab('world')">ğŸŒ æ¢ç´¢ä¸–ç•Œ</button>
            <button class="tab-btn" onclick="switchTab('training')">ğŸ¯ æ³¨æ„åŠ›è®­ç»ƒ</button>
        </nav>

        <!-- æ€»è§ˆé¡µé¢ -->
        <div id="dashboard" class="tab-content active">
            <h2 class="section-title">å­¦ä¹ æ¦‚å†µ</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalHomework">0</div>
                    <div class="stat-label">å¾…å®Œæˆä½œä¸š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalBooks">0</div>
                    <div class="stat-label">é˜…è¯»ä¹¦ç±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="studyDays">0</div>
                    <div class="stat-label">å·²å­¦ä¹ å¤©æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completedTasks">0</div>
                    <div class="stat-label">å·²å®Œæˆä»»åŠ¡</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <div class="stat-number" id="totalPoints">0</div>
                    <div class="stat-label">æ€»ç§¯åˆ†</div>
                </div>
            </div>

            <h3 class="section-title">ä»Šæ—¥ä»»åŠ¡</h3>
            <div id="todayTasks"></div>

            <h3 class="section-title">ğŸ“… ä»Šæ—¥ä½œæ¯å®Œæˆæƒ…å†µ</h3>
            <div id="scheduleProgress" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <div style="font-size: 24px; font-weight: bold; color: #333;">
                            å·²å®Œæˆ <span id="completedSchedule">0</span> / <span id="totalSchedule">0</span> é¡¹
                        </div>
                        <div style="font-size: 14px; color: #666; margin-top: 5px;">
                            å®Œæˆç‡: <span id="scheduleRate">0</span>%
                        </div>
                    </div>
                    <div style="font-size: 48px;">
                        <span id="scheduleEmoji">ğŸ“‹</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="scheduleProgressBar" style="width: 0%">0%</div>
                </div>
                <div style="text-align: center; margin-top: 15px; font-size: 14px; color: #666;">
                    ğŸ’¡ æ¯å®Œæˆä¸€é¡¹ä½œæ¯å¯è·å¾— <strong style="color: #667eea;">+1ç§¯åˆ†</strong>
                </div>
            </div>

            <h3 class="section-title">é˜…è¯»è¿›åº¦</h3>
            <div id="readingProgress"></div>

            <h3 class="section-title">ğŸ“… ä»Šæ—¥ä½œæ¯è¡¨</h3>
            <div class="schedule-container">
                <div class="schedule-input-row">
                    <input type="time" id="scheduleTime" value="07:00">
                    <input type="text" id="scheduleActivity" placeholder="æ´»åŠ¨å†…å®¹ï¼ˆå¦‚ï¼šèµ·åºŠã€æ—©é¤ã€å­¦ä¹ ç­‰ï¼‰">
                    <button class="btn btn-primary btn-small" onclick="addScheduleItem()">æ·»åŠ </button>
                </div>
                <div id="scheduleList" class="schedule-list"></div>
            </div>
        </div>

        <!-- ä½œä¸šç®¡ç†é¡µé¢ -->
        <div id="homework" class="tab-content">
            <h2 class="section-title">ä½œä¸šç®¡ç†</h2>

            <!-- ç•ªèŒ„é’Ÿ -->
            <div class="pomodoro-container">
                <h3 style="margin-bottom: 10px;">ğŸ… ç•ªèŒ„ä¸“æ³¨é’Ÿ</h3>
                <div class="pomodoro-status" id="pomodoroStatus">å‡†å¤‡å¼€å§‹å­¦ä¹ </div>
                <div class="pomodoro-timer" id="pomodoroTimer">25:00</div>
                <div class="pomodoro-controls">
                    <button class="pomodoro-btn" onclick="startPomodoro()">å¼€å§‹</button>
                    <button class="pomodoro-btn" onclick="pausePomodoro()">æš‚åœ</button>
                    <button class="pomodoro-btn" onclick="resetPomodoro()">é‡ç½®</button>
                </div>
                <div class="pomodoro-stats">
                    <span>ä»Šæ—¥å®Œæˆ: <strong id="todayPomodoros">0</strong> ä¸ªç•ªèŒ„é’Ÿ</span>
                    <span>ç´¯è®¡å­¦ä¹ : <strong id="totalStudyTime">0</strong> åˆ†é’Ÿ</span>
                </div>
            </div>

            <div class="input-group">
                <input type="text" id="homeworkTitle" placeholder="ä½œä¸šæ ‡é¢˜ï¼ˆå¦‚ï¼šæ•°å­¦å¯’å‡ä½œä¸šç¬¬1-10é¡µï¼‰">
                <select id="homeworkSubject">
                    <option value="è¯­æ–‡">è¯­æ–‡</option>
                    <option value="æ•°å­¦">æ•°å­¦</option>
                    <option value="è‹±è¯­">è‹±è¯­</option>
                    <option value="ç§‘å­¦">ç§‘å­¦</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                </select>
            </div>
            <div class="input-group">
                <textarea id="homeworkDesc" placeholder="ä½œä¸šè¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰"></textarea>
                <input type="date" id="homeworkDeadline">
                <button class="btn btn-primary" onclick="addHomework()">æ·»åŠ ä½œä¸š</button>
            </div>

            <h3 class="section-title">ä½œä¸šåˆ—è¡¨</h3>
            <div id="homeworkList"></div>
        </div>

        <!-- é˜…è¯»ç®¡ç†é¡µé¢ -->
        <div id="reading" class="tab-content">
            <h2 class="section-title">é˜…è¯»ç®¡ç†</h2>
            <div class="input-group">
                <input type="text" id="bookTitle" placeholder="ä¹¦å/æŠ¥çº¸åç§°">
                <input type="text" id="bookAuthor" placeholder="ä½œè€…ï¼ˆå¯é€‰ï¼‰">
                <select id="bookCategory">
                    <option value="å›¾ä¹¦">ğŸ“– å›¾ä¹¦</option>
                    <option value="å°è¯´">ğŸ“• å°è¯´</option>
                    <option value="æŠ¥çº¸">ğŸ“° æŠ¥çº¸</option>
                    <option value="æ‚å¿—">ğŸ“š æ‚å¿—</option>
                    <option value="æ¼«ç”»">ğŸ¨ æ¼«ç”»</option>
                    <option value="ç§‘æ™®">ğŸ”¬ ç§‘æ™®</option>
                    <option value="å…¶ä»–">ğŸ“„ å…¶ä»–</option>
                </select>
                <input type="number" id="bookPages" placeholder="æ€»é¡µæ•°" min="1">
                <input type="number" id="bookWords" placeholder="æ€»å­—æ•°ï¼ˆå¯é€‰ï¼‰" min="1">
                <button class="btn btn-primary" onclick="addBook()">æ·»åŠ åˆ°ä¹¦å•</button>
            </div>

            <h3 class="section-title">æˆ‘çš„ä¹¦å•</h3>
            <div id="bookList"></div>
        </div>

        <!-- å­¦ä¹ è®¡åˆ’é¡µé¢ -->
        <div id="plan" class="tab-content">
            <h2 class="section-title">å­¦ä¹ è®¡åˆ’</h2>
            <div class="input-group">
                <input type="text" id="planTitle" placeholder="è®¡åˆ’æ ‡é¢˜ï¼ˆå¦‚ï¼šæ¯å¤©èƒŒ20ä¸ªå•è¯ï¼‰">
                <select id="planType">
                    <option value="daily">æ¯æ—¥è®¡åˆ’</option>
                    <option value="weekly">æ¯å‘¨è®¡åˆ’</option>
                    <option value="custom">è‡ªå®šä¹‰</option>
                </select>
                <button class="btn btn-primary" onclick="addPlan()">æ·»åŠ è®¡åˆ’</button>
            </div>

            <h3 class="section-title">æˆ‘çš„è®¡åˆ’</h3>
            <div id="planList"></div>
        </div>

        <!-- å­¦ä¹ æµ‹è¯•é¡µé¢ -->
        <div id="test" class="tab-content">
            <div class="test-container">
                <h2 style="text-align: center; font-size: 32px; font-weight: bold; color: white; margin-bottom: 10px;">
                    ğŸ“‹ å­¦ä¹ è¿›åº¦æµ‹è¯•
                </h2>
                <p style="text-align: center; font-size: 18px; color: white; opacity: 0.9; margin-bottom: 30px;">
                    æ¯å‘¨æµ‹è¯•ï¼Œæ£€éªŒå­¦ä¹ æˆæœï¼Œè·å¾—ç§¯åˆ†å¥–åŠ±ï¼
                </p>

                <div class="test-stats-grid">
                    <div class="test-stat-card">
                        <div class="test-stat-number" id="totalTests">0</div>
                        <div class="test-stat-label">æ€»æµ‹è¯•æ¬¡æ•°</div>
                    </div>
                    <div class="test-stat-card">
                        <div class="test-stat-number" id="avgScore">0</div>
                        <div class="test-stat-label">å¹³å‡åˆ†</div>
                    </div>
                    <div class="test-stat-card">
                        <div class="test-stat-number" id="excellentCount">0</div>
                        <div class="test-stat-label">ä¼˜ç§€æ¬¡æ•°</div>
                    </div>
                    <div class="test-stat-card">
                        <div class="test-stat-number" id="testPoints">0</div>
                        <div class="test-stat-label">æµ‹è¯•è·å¾—ç§¯åˆ†</div>
                    </div>
                </div>

                <h3 style="color: white; margin: 30px 0 20px; font-size: 24px;">é€‰æ‹©æµ‹è¯•ç§‘ç›®</h3>
                <div class="test-subjects">
                    <div class="subject-card" onclick="startTest('è¯­æ–‡')">
                        <div class="subject-icon">ğŸ“š</div>
                        <div class="subject-name">è¯­æ–‡</div>
                        <div class="subject-desc">é˜…è¯»ç†è§£ã€å¤è¯—è¯</div>
                    </div>
                    <div class="subject-card" onclick="startTest('æ•°å­¦')">
                        <div class="subject-icon">ğŸ”¢</div>
                        <div class="subject-name">æ•°å­¦</div>
                        <div class="subject-desc">è®¡ç®—ã€åº”ç”¨é¢˜</div>
                    </div>
                    <div class="subject-card" onclick="startTest('è‹±è¯­')">
                        <div class="subject-icon">ğŸ”¤</div>
                        <div class="subject-name">è‹±è¯­</div>
                        <div class="subject-desc">å•è¯ã€è¯­æ³•</div>
                    </div>
                    <div class="subject-card" onclick="startTest('ç§‘å­¦')">
                        <div class="subject-icon">ğŸ”¬</div>
                        <div class="subject-name">ç§‘å­¦</div>
                        <div class="subject-desc">è‡ªç„¶ã€å®éªŒ</div>
                    </div>
                </div>
            </div>

            <div class="test-history">
                <h3 style="color: #333; margin-bottom: 20px; font-size: 24px;">ğŸ“Š æµ‹è¯•è®°å½•</h3>
                <div id="testRecords"></div>
            </div>
        </div>

        <!-- è¿åŠ¨æå‡é¡µé¢ -->
        <div id="sports" class="tab-content">
            <div class="sports-container">
                <h2 style="text-align: center; font-size: 32px; font-weight: bold; color: white; margin-bottom: 10px;">
                    ğŸ¸ è¿åŠ¨æå‡è®¡åˆ’
                </h2>
                <p style="text-align: center; font-size: 18px; color: white; opacity: 0.9; margin-bottom: 30px;">
                    å¼ºå¥ä½“é­„ï¼Œå…¨é¢å‘å±•ï¼è®°å½•è®­ç»ƒï¼Œè·å¾—ç§¯åˆ†å¥–åŠ±ï¼
                </p>

                <div class="sports-cards">
                    <!-- ç¾½æ¯›çƒå¡ç‰‡ -->
                    <div class="sport-card">
                        <div class="sport-header">
                            <div class="sport-icon-large">ğŸ¸</div>
                            <div class="sport-title">ç¾½æ¯›çƒ</div>
                        </div>

                        <div class="sport-stats">
                            <div class="sport-stat-item">
                                <div class="sport-stat-value" id="badmintonCount">0</div>
                                <div class="sport-stat-label">è®­ç»ƒæ¬¡æ•°</div>
                            </div>
                            <div class="sport-stat-item">
                                <div class="sport-stat-value" id="badmintonHours">0</div>
                                <div class="sport-stat-label">æ€»æ—¶é•¿(å°æ—¶)</div>
                            </div>
                        </div>

                        <div class="training-form">
                            <input type="number" id="badmintonDuration" placeholder="è®­ç»ƒæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰" min="1">
                            <select id="badmintonType">
                                <option value="åŸºç¡€ç»ƒä¹ ">åŸºç¡€ç»ƒä¹ </option>
                                <option value="å‘çƒè®­ç»ƒ">å‘çƒè®­ç»ƒ</option>
                                <option value="æ¥çƒè®­ç»ƒ">æ¥çƒè®­ç»ƒ</option>
                                <option value="å¯¹æ‰“ç»ƒä¹ ">å¯¹æ‰“ç»ƒä¹ </option>
                                <option value="æ¯”èµ›">æ¯”èµ›</option>
                            </select>
                            <textarea id="badmintonNote" placeholder="è®­ç»ƒç¬”è®°ï¼ˆå¯é€‰ï¼‰" rows="2"></textarea>
                            <button class="btn btn-primary" onclick="addTraining('badminton')">è®°å½•è®­ç»ƒ</button>
                        </div>

                        <div class="training-records">
                            <h4 style="margin: 15px 0 10px; color: #333;">æœ€è¿‘è®­ç»ƒ</h4>
                            <div id="badmintonRecords"></div>
                        </div>
                    </div>

                    <!-- è‡ªç”±æˆ·å¤–æ´»åŠ¨å¡ç‰‡ -->
                    <div class="sport-card">
                        <div class="sport-header">
                            <div class="sport-icon-large">ğŸŒ³</div>
                            <div class="sport-title">è‡ªç”±æˆ·å¤–æ´»åŠ¨</div>
                        </div>

                        <div class="sport-stats">
                            <div class="sport-stat-item">
                                <div class="sport-stat-value" id="outdoorCount">0</div>
                                <div class="sport-stat-label">æ´»åŠ¨æ¬¡æ•°</div>
                            </div>
                            <div class="sport-stat-item">
                                <div class="sport-stat-value" id="outdoorHours">0</div>
                                <div class="sport-stat-label">æ€»æ—¶é•¿(å°æ—¶)</div>
                            </div>
                        </div>

                        <div class="training-form">
                            <input type="number" id="outdoorDuration" placeholder="æ´»åŠ¨æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰" min="1">
                            <select id="outdoorType">
                                <option value="ğŸš´ éª‘è‡ªè¡Œè½¦">ï¿½ï¿½ éª‘è‡ªè¡Œè½¦</option>
                                <option value="ğŸ€ æ‰“ç¯®çƒ">ğŸ€ æ‰“ç¯®çƒ</option>
                                <option value="ğŸŠ æ¸¸æ³³">ğŸŠ æ¸¸æ³³</option>
                                <option value="ğŸƒ è·‘æ­¥">ğŸƒ è·‘æ­¥</option>
                                <option value="è‡ªå®šä¹‰">è‡ªå®šä¹‰æ´»åŠ¨</option>
                            </select>
                            <input type="text" id="outdoorCustom" placeholder="è‡ªå®šä¹‰æ´»åŠ¨åç§°ï¼ˆå¯é€‰ï¼‰" style="display: none;">
                            <textarea id="outdoorNote" placeholder="æ´»åŠ¨ç¬”è®°ï¼ˆå¯é€‰ï¼‰" rows="2"></textarea>
                            <button class="btn btn-primary" onclick="addTraining('outdoor')">è®°å½•æ´»åŠ¨</button>
                        </div>

                        <div class="training-records">
                            <h4 style="margin: 15px 0 10px; color: #333;">æœ€è¿‘æ´»åŠ¨</h4>
                            <div id="outdoorRecords"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sports-overview">
                <h3 style="color: #333; margin-bottom: 20px; font-size: 24px;">ğŸ† è¿åŠ¨æˆå°±</h3>
                <div class="achievement-grid">
                    <div class="achievement-item">
                        <div class="achievement-icon">ğŸ’ª</div>
                        <div class="achievement-name">æ€»è®­ç»ƒæ¬¡æ•°</div>
                        <div style="font-size: 24px; font-weight: bold; color: #333; margin-top: 10px;" id="totalTrainings">0</div>
                    </div>
                    <div class="achievement-item">
                        <div class="achievement-icon">â±ï¸</div>
                        <div class="achievement-name">æ€»è®­ç»ƒæ—¶é•¿</div>
                        <div style="font-size: 24px; font-weight: bold; color: #333; margin-top: 10px;" id="totalHours">0</div>
                    </div>
                    <div class="achievement-item">
                        <div class="achievement-icon">â­</div>
                        <div class="achievement-name">è¿åŠ¨ç§¯åˆ†</div>
                        <div style="font-size: 24px; font-weight: bold; color: #333; margin-top: 10px;" id="sportsPoints">0</div>
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h4 style="color: #333; margin-bottom: 15px;">ğŸ’¡ ç§¯åˆ†è§„åˆ™</h4>
                    <p style="color: #666; line-height: 1.8;">
                        â€¢ è®­ç»ƒ30åˆ†é’Ÿï¼š+10ç§¯åˆ†<br>
                        â€¢ è®­ç»ƒ60åˆ†é’Ÿï¼š+15ç§¯åˆ†<br>
                        â€¢ è®­ç»ƒ90åˆ†é’Ÿä»¥ä¸Šï¼š+20ç§¯åˆ†<br>
                        â€¢ åšæŒè¿åŠ¨ï¼Œå¼ºå¥ä½“é­„ï¼Œè·å¾—æ›´å¤šç§¯åˆ†ï¼
                    </p>
                </div>
            </div>
        </div>

        <!-- å®¶åŠ¡åŠ³åŠ¨é¡µé¢ -->
        <div id="chores" class="tab-content">
            <div class="sports-container">
                <h2 style="text-align: center; font-size: 32px; font-weight: bold; color: white; margin-bottom: 10px;">
                    ğŸ§¹ å®¶åŠ¡åŠ³åŠ¨
                </h2>
                <p style="text-align: center; font-size: 18px; color: white; opacity: 0.9; margin-bottom: 30px;">
                    åŠ³åŠ¨æœ€å…‰è£ï¼å®Œæˆå®¶åŠ¡è·å¾—ç§¯åˆ†å¥–åŠ±ï¼ŒåŸ¹å…»å¥½ä¹ æƒ¯ï¼
                </p>

                <!-- å®¶åŠ¡ç»Ÿè®¡ -->
                <div class="travel-stats">
                    <div class="travel-stat">
                        <div class="travel-stat-number" id="choreCount">0</div>
                        <div class="travel-stat-label">å®Œæˆæ¬¡æ•°</div>
                    </div>
                    <div class="travel-stat">
                        <div class="travel-stat-number" id="chorePoints">0</div>
                        <div class="travel-stat-label">è·å¾—ç§¯åˆ†</div>
                    </div>
                </div>

                <!-- å®¶åŠ¡ä»»åŠ¡å¡ç‰‡ -->
                <div class="chores-grid">
                    <!-- æ‰«åœ° -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ§¹</div>
                        <div class="chore-name">æ‰«åœ°</div>
                        <div class="chore-points">+5 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ‰«åœ°', 5)">å®Œæˆ</button>
                    </div>

                    <!-- æ‹–åœ° -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ§½</div>
                        <div class="chore-name">æ‹–åœ°</div>
                        <div class="chore-points">+8 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ‹–åœ°', 8)">å®Œæˆ</button>
                    </div>

                    <!-- æ´—ç¢— -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ½ï¸</div>
                        <div class="chore-name">æ´—ç¢—</div>
                        <div class="chore-points">+5 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ´—ç¢—', 5)">å®Œæˆ</button>
                    </div>

                    <!-- æ“¦æ¡Œå­ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸª‘</div>
                        <div class="chore-name">æ“¦æ¡Œå­</div>
                        <div class="chore-points">+3 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ“¦æ¡Œå­', 3)">å®Œæˆ</button>
                    </div>

                    <!-- å€’åƒåœ¾ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ—‘ï¸</div>
                        <div class="chore-name">å€’åƒåœ¾</div>
                        <div class="chore-points">+3 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('å€’åƒåœ¾', 3)">å®Œæˆ</button>
                    </div>

                    <!-- æ•´ç†æˆ¿é—´ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ›ï¸</div>
                        <div class="chore-name">æ•´ç†æˆ¿é—´</div>
                        <div class="chore-points">+10 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ•´ç†æˆ¿é—´', 10)">å®Œæˆ</button>
                    </div>

                    <!-- æ´—è¡£æœ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ‘•</div>
                        <div class="chore-name">æ´—è¡£æœ</div>
                        <div class="chore-points">+8 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ´—è¡£æœ', 8)">å®Œæˆ</button>
                    </div>

                    <!-- æ™¾è¡£æœ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸŒ</div>
                        <div class="chore-name">æ™¾è¡£æœ</div>
                        <div class="chore-points">+3 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ™¾è¡£æœ', 3)">å®Œæˆ</button>
                    </div>

                    <!-- å è¡£æœ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ‘”</div>
                        <div class="chore-name">å è¡£æœ</div>
                        <div class="chore-points">+5 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('å è¡£æœ', 5)">å®Œæˆ</button>
                    </div>

                    <!-- æµ‡èŠ± -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸŒ»</div>
                        <div class="chore-name">æµ‡èŠ±</div>
                        <div class="chore-points">+2 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æµ‡èŠ±', 2)">å®Œæˆ</button>
                    </div>

                    <!-- æ“¦çª—æˆ· -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸªŸ</div>
                        <div class="chore-name">æ“¦çª—æˆ·</div>
                        <div class="chore-points">+8 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('æ“¦çª—æˆ·', 8)">å®Œæˆ</button>
                    </div>

                    <!-- åšé¥­ -->
                    <div class="chore-card">
                        <div class="chore-icon">ğŸ³</div>
                        <div class="chore-name">å¸®å¿™åšé¥­</div>
                        <div class="chore-points">+15 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('å¸®å¿™åšé¥­', 15)">å®Œæˆ</button>
                    </div>

                    <!-- å¤§æ‰«é™¤ -->
                    <div class="chore-card" style="background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);">
                        <div class="chore-icon">ğŸ§¹</div>
                        <div class="chore-name">å¤§æ‰«é™¤</div>
                        <div class="chore-points">+20 ç§¯åˆ†</div>
                        <button class="chore-btn" onclick="completeChore('å¤§æ‰«é™¤', 20)">å®Œæˆ</button>
                    </div>
                </div>

                <!-- å®¶åŠ¡è®°å½• -->
                <div class="chore-records-section">
                    <h3 style="margin: 30px 0 15px; color: white; text-align: center;">ğŸ“‹ æœ€è¿‘å®Œæˆçš„å®¶åŠ¡</h3>
                    <div id="choreRecords" class="chore-records"></div>
                </div>
            </div>
        </div>

        <!-- ç§¯åˆ†å…‘æ¢é¡µé¢ -->
        <div id="rewards" class="tab-content">
            <h2 class="section-title">ğŸ ç§¯åˆ†å…‘æ¢ä¸­å¿ƒ</h2>
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 48px; font-weight: bold; color: #f5576c;">
                    <span id="currentPoints">0</span> ç§¯åˆ†
                </div>
                <p style="color: #666; margin-top: 10px;">é€šè¿‡å®Œæˆå­¦ä¹ ä»»åŠ¡è·å¾—ç§¯åˆ†ï¼Œå…‘æ¢å¥–åŠ±ï¼</p>
            </div>

            <h3 class="section-title">å¯å…‘æ¢å¥–åŠ±</h3>
            <div class="rewards-grid">
                <div class="reward-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; grid-column: span 2;">
                    <div class="reward-icon">âœˆï¸</div>
                    <div class="reward-title" style="color: white;">æ—…æ¸¸ç›®çš„åœ°æ™ºé€‰</div>
                    <div class="reward-cost" style="color: #ffd700;">5000 ç§¯åˆ†</div>
                    <p style="font-size: 14px; margin: 10px 0; opacity: 0.9;">è§£é”ä¸€ä¸ªæ¢¦æƒ³æ—…è¡ŒåŸå¸‚ï¼</p>
                    <button class="reward-btn" style="background: white; color: #667eea;" onclick="redeemTravel()">ç«‹å³å…‘æ¢</button>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">ğŸ’°</div>
                    <div class="reward-title">é›¶èŠ±é’± 10å…ƒ</div>
                    <div class="reward-cost">100 ç§¯åˆ†</div>
                    <button class="reward-btn" onclick="redeemReward('money', 100, 10)">ç«‹å³å…‘æ¢</button>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">ğŸ®</div>
                    <div class="reward-title">æ¸¸æˆæ—¶é—´ 30åˆ†é’Ÿ</div>
                    <div class="reward-cost">50 ç§¯åˆ†</div>
                    <button class="reward-btn" onclick="redeemReward('game', 50, 30)">ç«‹å³å…‘æ¢</button>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">ğŸ’µ</div>
                    <div class="reward-title">é›¶èŠ±é’± 5å…ƒ</div>
                    <div class="reward-cost">50 ç§¯åˆ†</div>
                    <button class="reward-btn" onclick="redeemReward('money', 50, 5)">ç«‹å³å…‘æ¢</button>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">ğŸ¯</div>
                    <div class="reward-title">æ¸¸æˆæ—¶é—´ 60åˆ†é’Ÿ</div>
                    <div class="reward-cost">100 ç§¯åˆ†</div>
                    <button class="reward-btn" onclick="redeemReward('game', 100, 60)">ç«‹å³å…‘æ¢</button>
                </div>
            </div>

            <h3 class="section-title" style="margin-top: 40px;">ğŸ“‹ ç§¯åˆ†è·å–è§„åˆ™</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ“</div>
                        <div style="font-weight: bold; color: #667eea;">+10 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">å®Œæˆä¸€ä¸ªä½œä¸š</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ…</div>
                        <div style="font-weight: bold; color: #667eea;">+5 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">å®Œæˆä¸€ä¸ªç•ªèŒ„é’Ÿ</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ“–</div>
                        <div style="font-weight: bold; color: #667eea;">+20 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">è¯»å®Œä¸€æœ¬ä¹¦</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ“š</div>
                        <div style="font-weight: bold; color: #667eea;">+2 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">æ›´æ–°é˜…è¯»è¿›åº¦</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ“…</div>
                        <div style="font-weight: bold; color: #667eea;">+8 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">å®Œæˆå­¦ä¹ è®¡åˆ’</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">â°</div>
                        <div style="font-weight: bold; color: #667eea;">+1 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">å®Œæˆä½œæ¯é¡¹</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ“‹</div>
                        <div style="font-weight: bold; color: #667eea;">+10~30 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">å­¦ä¹ æµ‹è¯•</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">ğŸ¸</div>
                        <div style="font-weight: bold; color: #667eea;">+10~20 ç§¯åˆ†</div>
                        <div style="color: #666; font-size: 14px;">è¿åŠ¨è®­ç»ƒ</div>
                    </div>
                </div>
            </div>

            <h3 class="section-title">ğŸ“œ ç§¯åˆ†è®°å½•</h3>
            <div id="pointsHistory" class="points-history"></div>
        </div>

        <!-- æ¢ç´¢ä¸–ç•Œé¡µé¢ -->
        <div id="world" class="tab-content">
            <div class="world-container">
                <h2 class="map-title">ğŸŒ æ¢ç´¢ä¸­å›½ Â· æ¢¦æƒ³ä¹‹æ—…</h2>
                <p style="text-align: center; font-size: 18px; margin-bottom: 20px; opacity: 0.9;">
                    åŠªåŠ›å­¦ä¹ ï¼Œç§¯ç´¯ç§¯åˆ†ï¼Œè§£é”ä½ çš„æ¢¦æƒ³æ—…è¡Œç›®çš„åœ°ï¼
                </p>

                <div class="travel-stats">
                    <div class="travel-stat">
                        <div class="travel-stat-number" id="unlockedCities">0</div>
                        <div class="travel-stat-label">å·²è§£é”åŸå¸‚</div>
                    </div>
                    <div class="travel-stat">
                        <div class="travel-stat-number" id="totalCities">12</div>
                        <div class="travel-stat-label">å…¨éƒ¨åŸå¸‚</div>
                    </div>
                    <div class="travel-stat">
                        <div class="travel-stat-number" id="travelPoints">0</div>
                        <div class="travel-stat-label">å½“å‰ç§¯åˆ†</div>
                    </div>
                </div>

                <div class="china-map">
                    <div style="text-align: center; font-size: 24px; font-weight: bold; margin-bottom: 20px;">
                        ğŸ—ºï¸ ä¸­å›½çƒ­é—¨æ—…æ¸¸åŸå¸‚
                    </div>
                    <div class="cities-grid" id="citiesGrid"></div>
                </div>

                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-top: 20px;">
                    <h3 style="margin-bottom: 15px;">ğŸ’¡ å¦‚ä½•è§£é”æ—…æ¸¸ç›®çš„åœ°ï¼Ÿ</h3>
                    <p style="font-size: 16px; line-height: 1.8;">
                        1ï¸âƒ£ é€šè¿‡å®Œæˆä½œä¸šã€é˜…è¯»ã€å­¦ä¹ è®¡åˆ’ç­‰ä»»åŠ¡ç§¯ç´¯ç§¯åˆ†<br>
                        2ï¸âƒ£ åœ¨"ç§¯åˆ†å…‘æ¢"é¡µé¢ç”¨ <strong>5000ç§¯åˆ†</strong> å…‘æ¢ä¸€æ¬¡æ—…æ¸¸ç›®çš„åœ°æ™ºé€‰<br>
                        3ï¸âƒ£ å…‘æ¢åå¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªåŸå¸‚è§£é”<br>
                        4ï¸âƒ£ è§£é”çš„åŸå¸‚ä»£è¡¨ä½ å¯ä»¥å’Œå®¶äººä¸€èµ·å»æ—…è¡Œå•¦ï¼ğŸ‰
                    </p>
                </div>
            </div>
        </div>

        <!-- æ³¨æ„åŠ›è®­ç»ƒé¡µé¢ -->
        <div id="training" class="tab-content">
            <h2 class="section-title">æ³¨æ„åŠ›è®­ç»ƒ</h2>
            <p style="color: #666; margin-bottom: 20px;">é€šè¿‡æ¸¸æˆè®­ç»ƒæå‡ä¸“æ³¨åŠ›å’Œååº”èƒ½åŠ›</p>
            <button class="btn btn-primary" onclick="openTraining()">æ‰“å¼€è®­ç»ƒç³»ç»Ÿ</button>
        </div>
    </div>

    <script>
        // æ•°æ®å­˜å‚¨
        let data = {
            homework: [],
            books: [],
            plans: [],
            studyDays: 0,
            completedTasks: 0,
            lastVisit: null,
            pomodoros: {
                today: 0,
                totalTime: 0,
                lastDate: null
            },
            points: {
                total: 0,
                history: [],
                dailyTasks: {}
            },
            schedule: [],
            travel: {
                unlockedCities: [],
                visitedCities: [],
                cities: [
                    { id: 1, name: 'åŒ—äº¬', icon: 'ğŸ›ï¸', desc: 'æ•…å®«ã€é•¿åŸã€å¤©å®‰é—¨',
                      details: 'ğŸ›ï¸ **åŒ—äº¬** - ä¸­å›½é¦–éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ•…å®«åšç‰©é™¢ - æ˜æ¸…ä¸¤ä»£çš‡å®¶å®«æ®¿\nâ€¢ ä¸‡é‡Œé•¿åŸ - ä¸–ç•Œä¸ƒå¤§å¥‡è¿¹ä¹‹ä¸€\nâ€¢ å¤©å®‰é—¨å¹¿åœº - ä¸–ç•Œä¸Šæœ€å¤§çš„åŸå¸‚å¹¿åœº\nâ€¢ é¢å’Œå›­ - çš‡å®¶å›­æ—å›­æ—è‰ºæœ¯æ°ä½œ\nâ€¢ å¤©å› - æ˜æ¸…çš‡å¸ç¥­å¤©çš„åœºæ‰€\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nåŒ—äº¬çƒ¤é¸­ã€è€åŒ—äº¬ç‚¸é…±é¢ï¿½ï¿½ï¿½è±†æ±ç„¦åœˆã€é©´æ‰“æ»š\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼ˆ4-5æœˆã€9-10æœˆï¼‰æ°”å€™å®œäºº' },
                    { id: 2, name: 'ä¸Šæµ·', icon: 'ğŸ™ï¸', desc: 'ä¸œæ–¹æ˜ç ã€å¤–æ»©ã€è¿ªå£«å°¼',
                      details: 'ğŸ™ï¸ **ä¸Šæµ·** - é­”éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ä¸œæ–¹æ˜ç å¡” - ä¸Šæµ·åœ°æ ‡å»ºç­‘\nâ€¢ å¤–æ»© - ä¸‡å›½å»ºç­‘åšè§ˆç¾¤\nâ€¢ ä¸Šæµ·è¿ªå£«å°¼ - ä¸­å›½é¦–åº§è¿ªå£«å°¼\nâ€¢ è±«å›­ - æ˜ä»£ç§å®¶å›­æ—\nâ€¢ å—äº¬è·¯æ­¥è¡Œè¡— - ä¸­åå•†ä¸šç¬¬ä¸€è¡—\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nå°ç¬¼åŒ…ã€ç”Ÿç…åŒ…ã€æ’éª¨å¹´ç³•ã€èŸ¹å£³é»„\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œé¿å…æ¢…é›¨å­£èŠ‚' },
                    { id: 3, name: 'è¥¿å®‰', icon: 'ğŸ—¿', desc: 'å…µé©¬ä¿‘ã€å¤åŸå¢™ã€å¤§é›å¡”',
                      details: 'ğŸ—¿ **è¥¿å®‰** - åä¸‰æœå¤éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ç§¦å§‹çš‡å…µé©¬ä¿‘ - ä¸–ç•Œç¬¬å…«å¤§å¥‡è¿¹\nâ€¢ è¥¿å®‰å¤åŸå¢™ - ä¸­å›½ä¿å­˜æœ€å®Œæ•´çš„å¤åŸå¢™\nâ€¢ å¤§é›å¡” - ç„å¥˜æ³•å¸ˆè¯‘ç»ä¹‹åœ°\nâ€¢ åæ¸…æ±  - æ¨è´µå¦ƒæ²æµ´ä¹‹åœ°\nâ€¢ å›æ°‘è¡— - ç¾é£Ÿå¤©å ‚\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè‚‰å¤¹é¦ã€ç¾Šè‚‰æ³¡é¦ã€å‡‰çš®ã€biangbiangé¢\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ4-5æœˆå’Œ9-10æœˆ' },
                    { id: 4, name: 'æˆéƒ½', icon: 'ğŸ¼', desc: 'å¤§ç†ŠçŒ«åŸºåœ°ã€å®½çª„å··å­',
                      details: 'ğŸ¼ **æˆéƒ½** - å¤©åºœä¹‹å›½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤§ç†ŠçŒ«ç¹è‚²åŸºåœ° - å›½å®ä¹‹å®¶\nâ€¢ å®½çª„å··å­ - æ¸…ä»£å¤è¡—é“\nâ€¢ é”¦é‡Œ - ä¸‰å›½æ–‡åŒ–è¡—åŒº\nâ€¢ éƒ½æ±Ÿå ° - å¤ä»£æ°´åˆ©å·¥ç¨‹å¥‡è¿¹\nâ€¢ é’åŸå±± - é“æ•™å‘æºåœ°\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nç«é”…ã€ä¸²ä¸²é¦™ã€éº»å©†è±†è…ã€æ‹…æ‹…é¢ã€å…”å¤´\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\nå…¨å¹´çš†å®œï¼Œå¤å­£ç¨çƒ­' },
                    { id: 5, name: 'æ­å·', icon: 'ğŸŒŠ', desc: 'è¥¿æ¹–ã€çµéšå¯ºã€å®‹åŸ',
                      details: 'ğŸŒŠ **æ­å·** - äººé—´å¤©å ‚\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ è¥¿æ¹– - æ·¡å¦†æµ“æŠ¹æ€»ç›¸å®œ\nâ€¢ çµéšå¯º - æ±Ÿå—è‘—åå¤åˆ¹\nâ€¢ é›·å³°å¡” - ç™½å¨˜å­ä¼ è¯´åœ°\nâ€¢ å®‹åŸ - ç»™æˆ‘ä¸€å¤©è¿˜ä½ åƒå¹´\nâ€¢ åƒå²›æ¹– - å¤©ä¸‹ç¬¬ä¸€ç§€æ°´\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè¥¿æ¹–é†‹é±¼ã€ä¸œå¡è‚‰ã€é¾™äº•è™¾ä»ã€å«èŠ±é¸¡\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ3-5æœˆå’Œ9-11æœˆ' },
                    { id: 6, name: 'æ¡‚æ—', icon: 'â›°ï¸', desc: 'æ¼“æ±Ÿã€è±¡é¼»å±±ã€é˜³æœ”',
                      details: 'â›°ï¸ **æ¡‚æ—** - å±±æ°´ç”²å¤©ä¸‹\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ¼“æ±Ÿ - äººæ°‘å¸20å…ƒèƒŒæ™¯å›¾\nâ€¢ è±¡é¼»å±± - æ¡‚æ—åŸå¾½\nâ€¢ é˜³æœ”è¥¿è¡— - åœ°çƒæ‘\nâ€¢ é¾™è„Šæ¢¯ç”° - å¤§åœ°é›•å¡‘\nâ€¢ èŠ¦ç¬›å²© - å¤§è‡ªç„¶è‰ºæœ¯ä¹‹å®«\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¡‚æ—ç±³ç²‰ã€å•¤é…’é±¼ã€è”æµ¦èŠ‹å¤´æ‰£è‚‰\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n4-10æœˆï¼Œé›¨å­£å±±æ°´æ›´ç¾' },
                    { id: 7, name: 'ä¸‰äºš', icon: 'ğŸ–ï¸', desc: 'å¤©æ¶¯æµ·è§’ã€äºšé¾™æ¹¾ã€èœˆæ”¯æ´²å²›',
                      details: 'ğŸ–ï¸ **ä¸‰äºš** - ä¸œæ–¹å¤å¨å¤·\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤©æ¶¯æµ·è§’ - æµªæ¼«å®£è¨€åœ°\nâ€¢ äºšé¾™æ¹¾ - å¤©ä¸‹ç¬¬ä¸€æ¹¾\nâ€¢ èœˆæ”¯æ´²å²› - ä¸­å›½é©¬å°”ä»£å¤«\nâ€¢ å—å±±å¯º - 108ç±³æµ·ä¸Šè§‚éŸ³\nâ€¢ äºšç‰¹å…°è’‚æ–¯ - æ°´ä¸Šä¹å›­\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¤°å­é¸¡ã€æµ·é²œå¤§é¤ã€æ¸…è¡¥å‡‰ã€æµ·å—ç²‰\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n10æœˆè‡³æ¬¡å¹´3æœˆï¼Œé¿å¯’èƒœåœ°' },
                    { id: 8, name: 'ä¸½æ±Ÿ', icon: 'ğŸ”ï¸', desc: 'å¤åŸã€ç‰é¾™é›ªå±±ã€æ³¸æ²½æ¹–',
                      details: 'ğŸ”ï¸ **ä¸½æ±Ÿ** - è‰³é‡ä¹‹éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ä¸½æ±Ÿå¤åŸ - ä¸–ç•Œæ–‡åŒ–é—äº§\nâ€¢ ç‰é¾™é›ªå±± - çº³è¥¿æ—ç¥å±±\nâ€¢ æ³¸æ²½æ¹– - å¥³å„¿å›½\nâ€¢ è“æœˆè°· - é«˜åŸè“å®çŸ³\nâ€¢ æŸæ²³å¤é•‡ - èŒ¶é©¬å¤é“é‡é•‡\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè…Šæ’éª¨ç«é”…ã€é¸¡è±†å‡‰ç²‰ã€ä¸½æ±Ÿç²‘ç²‘ã€é²œèŠ±é¥¼\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\nå…¨å¹´çš†å®œï¼Œæ˜¥ç§‹æœ€ä½³' },
                    { id: 9, name: 'å¦é—¨', icon: 'ğŸŒ´', desc: 'é¼“æµªå±¿ã€å—æ™®é™€å¯ºã€ç¯å²›è·¯',
                      details: 'ğŸŒ´ **å¦é—¨** - æµ·ä¸ŠèŠ±å›­\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ é¼“æµªå±¿ - ä¸‡å›½å»ºç­‘åšè§ˆ\nâ€¢ å—æ™®é™€å¯º - åƒå¹´å¤åˆ¹\nâ€¢ ç¯å²›è·¯ - æœ€ç¾é©¬æ‹‰æ¾èµ›é“\nâ€¢ æ›¾ååµ - æ–‡è‰ºå°æ¸”æ‘\nâ€¢ å¦é—¨å¤§å­¦ - ä¸­å›½æœ€ç¾å¤§å­¦\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ²™èŒ¶é¢ã€æµ·è›ç…ã€åœŸç¬‹å†»ã€èŠ±ç”Ÿæ±¤\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œé¿å¼€å°é£å­£' },
                    { id: 10, name: 'é’å²›', icon: 'ğŸº', desc: 'æ ˆæ¡¥ã€å…«å¤§å…³ã€å´‚å±±',
                      details: 'ğŸº **é’å²›** - çº¢ç“¦ç»¿æ ‘ç¢§æµ·è“å¤©\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ ˆæ¡¥ - é’å²›æ ‡å¿—\nâ€¢ å…«å¤§å…³ - ä¸‡å›½å»ºç­‘åšè§ˆä¼š\nâ€¢ å´‚å±± - æµ·ä¸Šç¬¬ä¸€åå±±\nâ€¢ äº”å››å¹¿åœº - åŸå¸‚å®¢å…\nâ€¢ é’å²›å•¤é…’åšç‰©é¦† - å•¤é…’æ–‡åŒ–\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\né’å²›å•¤é…’ã€æµ·é²œå¤§é¤ã€çƒ¤é±¿é±¼ã€è¾£ç‚’è›¤èœŠ\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n5-10æœˆï¼Œ8æœˆæœ‰å•¤é…’èŠ‚' },
                    { id: 11, name: 'è‹å·', icon: 'ğŸ¯', desc: 'å›­æ—ã€å‘¨åº„ã€å¯’å±±å¯º',
                      details: 'ğŸ¯ **è‹å·** - ä¸œæ–¹å¨å°¼æ–¯\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ‹™æ”¿å›­ - ä¸­å›½å››å¤§åå›­ä¹‹é¦–\nâ€¢ ç‹®å­æ— - å‡å±±ç‹å›½\nâ€¢ å‘¨åº„å¤é•‡ - ä¸­å›½ç¬¬ä¸€æ°´ä¹¡\nâ€¢ å¯’å±±å¯º - å¤œåŠé’Ÿå£°åˆ°å®¢èˆ¹\nâ€¢ è™ä¸˜ - å´ä¸­ç¬¬ä¸€åèƒœ\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¾é¼ æ¡‚é±¼ã€å¤ªæ¹–ä¸‰ç™½ã€è‹å¼æœˆé¥¼ã€ç¢§èºæ˜¥èŒ¶\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ4-5æœˆå’Œ9-10æœˆ' },
                    { id: 12, name: 'å¼ å®¶ç•Œ', icon: 'ğŸŒ²', desc: 'å¤©é—¨å±±ã€ç»ç’ƒæ ˆé“ã€é»„é¾™æ´',
                      details: 'ğŸŒ² **å¼ å®¶ç•Œ** - ç¼©å°ç‰ˆä»™å¢ƒ\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤©é—¨å±± - ä¸–ç•Œæœ€é•¿ç´¢é“\nâ€¢ ç»ç’ƒæ ˆé“ - æ‚¬å´–ä¸Šçš„å¿ƒè·³\nâ€¢ é»„é¾™æ´ - åœ°ä¸‹æ˜ç \nâ€¢ è¢å®¶ç•Œ - é˜¿å‡¡è¾¾å–æ™¯åœ°\nâ€¢ é‡‘é­æºª - å¤©ä¸‹æœ€ç¾æºªæµ\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nä¸‰ä¸‹é”…ã€è‘›æ ¹ç²‰ã€åœŸå®¶è…Šè‚‰ã€å²©è€³ç‚–é¸¡\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ9-11æœˆæœ€ç¾' }
                ]
            }
        };

        // ç•ªèŒ„é’Ÿå˜é‡
        let pomodoroTimer = null;
        let pomodoroSeconds = 25 * 60; // 25åˆ†é’Ÿ
        let pomodoroRunning = false;
        let pomodoroMode = 'work'; // 'work' æˆ– 'break'

        // åˆå§‹åŒ–
        function init() {
            loadData();
            updateDate();
            updateDashboard();
            renderHomework();
            renderBooks();
            renderPlans();
            updatePomodoroStats();
            updatePointsDisplay();
            renderPointsHistory();
            renderSchedule();
            renderCities();
            renderTestRecords();
            updateTestStats();
            renderSportsRecords();
            updateSportsStats();
            renderChoreRecords();
            updateChoreStats();
        }

        // åŠ è½½æ•°æ®
        function loadData() {
            const saved = localStorage.getItem('winterStudyData');
            if (saved) {
                data = JSON.parse(saved);
                // ç¡®ä¿ç•ªèŒ„é’Ÿæ•°æ®å­˜åœ¨
                if (!data.pomodoros) {
                    data.pomodoros = { today: 0, totalTime: 0, lastDate: null };
                }
                // ç¡®ä¿ç§¯åˆ†æ•°æ®å­˜åœ¨
                if (!data.points) {
                    data.points = { total: 0, history: [], dailyTasks: {} };
                }
                // ç¡®ä¿æ¯æ—¥ä»»åŠ¡è®°å½•å­˜åœ¨ï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰
                if (!data.points.dailyTasks) {
                    data.points.dailyTasks = {};
                }
                // ç¡®ä¿ä½œæ¯è¡¨æ•°æ®å­˜åœ¨
                if (!data.schedule) {
                    data.schedule = [];
                }
                // ç¡®ä¿æ—…æ¸¸æ•°æ®å­˜åœ¨
                if (!data.travel) {
                    data.travel = {
                        unlockedCities: [],
                        visitedCities: [],
                        cities: [
                            { id: 1, name: 'åŒ—äº¬', icon: 'ğŸ›ï¸', desc: 'æ•…å®«ã€é•¿åŸã€å¤©å®‰é—¨',
                              details: 'ğŸ›ï¸ **åŒ—äº¬** - ä¸­å›½é¦–éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ•…å®«åšç‰©é™¢ - æ˜æ¸…ä¸¤ä»£çš‡å®¶å®«æ®¿\nâ€¢ ä¸‡é‡Œé•¿åŸ - ä¸–ç•Œä¸ƒå¤§å¥‡è¿¹ä¹‹ä¸€\nâ€¢ å¤©å®‰é—¨å¹¿åœº - ä¸–ç•Œä¸Šæœ€å¤§çš„åŸå¸‚å¹¿åœº\nâ€¢ é¢å’Œå›­ - çš‡å®¶å›­æ—è‰ºæœ¯æ°ä½œ\nâ€¢ å¤©å› - æ˜æ¸…çš‡å¸ç¥­å¤©çš„åœºæ‰€\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nåŒ—äº¬çƒ¤é¸­ã€è€åŒ—äº¬ç‚¸é…±é¢ã€è±†æ±ç„¦åœˆã€é©´æ‰“æ»š\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼ˆ4-5æœˆã€9-10æœˆï¼‰æ°”å€™å®œäºº' },
                            { id: 2, name: 'ä¸Šæµ·', icon: 'ğŸ™ï¸', desc: 'ä¸œæ–¹æ˜ç ã€å¤–æ»©ã€è¿ªå£«å°¼',
                              details: 'ğŸ™ï¸ **ä¸Šæµ·** - é­”éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ä¸œæ–¹æ˜ç å¡” - ä¸Šæµ·åœ°æ ‡å»ºç­‘\nâ€¢ å¤–æ»© - ä¸‡å›½å»ºç­‘åšè§ˆç¾¤\nâ€¢ ä¸Šæµ·è¿ªå£«å°¼ - ä¸­å›½é¦–åº§è¿ªå£«å°¼\nâ€¢ è±«å›­ - æ˜ä»£ç§å®¶å›­æ—\nâ€¢ å—äº¬è·¯æ­¥è¡Œè¡— - ä¸­åå•†ä¸šç¬¬ä¸€è¡—\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nå°ç¬¼åŒ…ã€ç”Ÿç…åŒ…ã€æ’éª¨å¹´ç³•ã€èŸ¹å£³é»„\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œé¿å…æ¢…é›¨å­£èŠ‚' },
                            { id: 3, name: 'è¥¿å®‰', icon: 'ğŸ—¿', desc: 'å…µé©¬ä¿‘ã€å¤åŸå¢™ã€å¤§é›å¡”',
                              details: 'ğŸ—¿ **è¥¿å®‰** - åä¸‰æœå¤éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ç§¦å§‹çš‡å…µé©¬ä¿‘ - ä¸–ç•Œç¬¬å…«å¤§å¥‡è¿¹\nâ€¢ è¥¿å®‰å¤åŸå¢™ - ä¸­å›½ä¿å­˜æœ€å®Œæ•´çš„å¤åŸå¢™\nâ€¢ å¤§é›å¡” - ç„å¥˜æ³•å¸ˆè¯‘ç»ä¹‹åœ°\nâ€¢ åæ¸…æ±  - æ¨è´µå¦ƒæ²æµ´ä¹‹åœ°\nâ€¢ å›æ°‘è¡— - ç¾é£Ÿå¤©å ‚\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè‚‰å¤¹é¦ã€ç¾Šè‚‰æ³¡é¦ã€å‡‰çš®ã€biangbiangé¢\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ4-5æœˆå’Œ9-10æœˆ' },
                            { id: 4, name: 'æˆéƒ½', icon: 'ğŸ¼', desc: 'å¤§ç†ŠçŒ«åŸºåœ°ã€å®½çª„å··å­',
                              details: 'ğŸ¼ **æˆéƒ½** - å¤©åºœä¹‹å›½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤§ç†ŠçŒ«ç¹è‚²åŸºåœ° - å›½å®ä¹‹å®¶\nâ€¢ å®½çª„å··å­ - æ¸…ä»£å¤è¡—é“\nâ€¢ é”¦é‡Œ - ä¸‰å›½æ–‡åŒ–è¡—åŒº\nâ€¢ éƒ½æ±Ÿå ° - å¤ä»£æ°´åˆ©å·¥ç¨‹å¥‡è¿¹\nâ€¢ é’åŸå±± - é“æ•™å‘æºåœ°\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nç«é”…ã€ä¸²ä¸²é¦™ã€éº»å©†è±†è…ã€æ‹…æ‹…é¢ã€å…”å¤´\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\nå…¨å¹´çš†å®œï¼Œå¤å­£ç¨çƒ­' },
                            { id: 5, name: 'æ­å·', icon: 'ğŸŒŠ', desc: 'è¥¿æ¹–ã€çµéšå¯ºã€å®‹åŸ',
                              details: 'ğŸŒŠ **æ­å·** - äººé—´å¤©å ‚\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ è¥¿æ¹– - æ·¡å¦†æµ“æŠ¹æ€»ç›¸å®œ\nâ€¢ çµéšå¯º - æ±Ÿå—è‘—åå¤åˆ¹\nâ€¢ é›·å³°å¡” - ç™½å¨˜å­ä¼ è¯´åœ°\nâ€¢ å®‹åŸ - ç»™æˆ‘ä¸€å¤©è¿˜ä½ åƒå¹´\nâ€¢ åƒå²›æ¹– - å¤©ä¸‹ç¬¬ä¸€ç§€æ°´\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè¥¿æ¹–é†‹é±¼ã€ä¸œå¡è‚‰ã€é¾™äº•è™¾ä»ã€å«èŠ±é¸¡\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ3-5æœˆå’Œ9-11æœˆ' },
                            { id: 6, name: 'æ¡‚æ—', icon: 'â›°ï¸', desc: 'æ¼“æ±Ÿã€è±¡é¼»å±±ã€é˜³æœ”',
                              details: 'â›°ï¸ **æ¡‚æ—** - å±±æ°´ç”²å¤©ä¸‹\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ¼“æ±Ÿ - äººæ°‘å¸20å…ƒèƒŒæ™¯å›¾\nâ€¢ è±¡é¼»å±± - æ¡‚æ—åŸå¾½\nâ€¢ é˜³æœ”è¥¿è¡— - åœ°çƒæ‘\nâ€¢ é¾™è„Šæ¢¯ç”° - å¤§åœ°é›•å¡‘\nâ€¢ èŠ¦ç¬›å²© - å¤§è‡ªç„¶è‰ºæœ¯ä¹‹å®«\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¡‚æ—ç±³ç²‰ã€å•¤é…’é±¼ã€è”æµ¦èŠ‹å¤´æ‰£è‚‰\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n4-10æœˆï¼Œé›¨å­£å±±æ°´æ›´ç¾' },
                            { id: 7, name: 'ä¸‰äºš', icon: 'ğŸ–ï¸', desc: 'å¤©æ¶¯æµ·è§’ã€äºšé¾™æ¹¾ã€èœˆæ”¯æ´²å²›',
                              details: 'ğŸ–ï¸ **ä¸‰äºš** - ä¸œæ–¹å¤å¨å¤·\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤©æ¶¯æµ·è§’ - æµªæ¼«å®£è¨€åœ°\nâ€¢ äºšé¾™æ¹¾ - å¤©ä¸‹ç¬¬ä¸€æ¹¾\nâ€¢ èœˆæ”¯æ´²å²› - ä¸­å›½é©¬å°”ä»£å¤«\nâ€¢ å—å±±å¯º - 108ç±³æµ·ä¸Šè§‚éŸ³\nâ€¢ äºšç‰¹å…°è’‚æ–¯ - æ°´ä¸Šä¹å›­\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¤°å­é¸¡ã€æµ·é²œå¤§é¤ã€æ¸…è¡¥å‡‰ã€æµ·å—ç²‰\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n10æœˆè‡³æ¬¡å¹´3æœˆï¼Œé¿å¯’èƒœåœ°' },
                            { id: 8, name: 'ä¸½æ±Ÿ', icon: 'ğŸ”ï¸', desc: 'å¤åŸã€ç‰é¾™é›ªå±±ã€æ³¸æ²½æ¹–',
                              details: 'ğŸ”ï¸ **ä¸½æ±Ÿ** - è‰³é‡ä¹‹éƒ½\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ ä¸½æ±Ÿå¤åŸ - ä¸–ç•Œæ–‡åŒ–é—äº§\nâ€¢ ç‰é¾™é›ªå±± - çº³è¥¿æ—ç¥å±±\nâ€¢ æ³¸æ²½æ¹– - å¥³å„¿å›½\nâ€¢ è“æœˆè°· - é«˜åŸè“å®çŸ³\nâ€¢ æŸæ²³å¤é•‡ - èŒ¶é©¬å¤é“é‡é•‡\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nè…Šæ’éª¨ç«é”…ã€é¸¡è±†å‡‰ç²‰ã€ä¸½æ±Ÿç²‘ç²‘ã€é²œèŠ±é¥¼\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\nå…¨å¹´çš†å®œï¼Œæ˜¥ç§‹æœ€ä½³' },
                            { id: 9, name: 'å¦é—¨', icon: 'ğŸŒ´', desc: 'é¼“æµªå±¿ã€å—æ™®é™€å¯ºã€ç¯å²›è·¯',
                              details: 'ğŸŒ´ **å¦é—¨** - æµ·ä¸ŠèŠ±å›­\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ é¼“æµªå±¿ - ä¸‡å›½å»ºç­‘åšè§ˆ\nâ€¢ å—æ™®é™€å¯º - åƒå¹´å¤åˆ¹\nâ€¢ ç¯å²›è·¯ - æœ€ç¾é©¬æ‹‰æ¾èµ›é“\nâ€¢ æ›¾ååµ - æ–‡è‰ºå°æ¸”æ‘\nâ€¢ å¦é—¨å¤§å­¦ - ä¸­å›½æœ€ç¾å¤§å­¦\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ²™èŒ¶é¢ã€æµ·è›ç…ã€åœŸç¬‹å†»ã€èŠ±ç”Ÿæ±¤\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œé¿å¼€å°é£å­£' },
                            { id: 10, name: 'é’å²›', icon: 'ğŸº', desc: 'æ ˆæ¡¥ã€å…«å¤§å…³ã€å´‚å±±',
                              details: 'ğŸº **é’å²›** - çº¢ç“¦ç»¿æ ‘ç¢§æµ·è“å¤©\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ ˆæ¡¥ - é’å²›æ ‡å¿—\nâ€¢ å…«å¤§å…³ - ä¸‡å›½å»ºç­‘åšè§ˆä¼š\nâ€¢ å´‚å±± - æµ·ä¸Šç¬¬ä¸€åå±±\nâ€¢ äº”å››å¹¿åœº - åŸå¸‚å®¢å…\nâ€¢ é’å²›å•¤é…’åšç‰©é¦† - å•¤é…’æ–‡åŒ–\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\né’å²›å•¤é…’ã€æµ·é²œå¤§é¤ã€çƒ¤é±¿é±¼ã€è¾£ç‚’è›¤èœŠ\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\n5-10æœˆï¼Œ8æœˆæœ‰å•¤é…’èŠ‚' },
                            { id: 11, name: 'è‹å·', icon: 'ğŸ¯', desc: 'å›­æ—ã€å‘¨åº„ã€å¯’å±±å¯º',
                              details: 'ğŸ¯ **è‹å·** - ä¸œæ–¹å¨å°¼æ–¯\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ æ‹™æ”¿å›­ - ä¸­å›½å››å¤§åå›­ä¹‹é¦–\nâ€¢ ç‹®å­æ— - å‡å±±ç‹å›½\nâ€¢ å‘¨åº„å¤é•‡ - ä¸­å›½ç¬¬ä¸€æ°´ä¹¡\nâ€¢ å¯’å±±å¯º - å¤œåŠé’Ÿå£°åˆ°å®¢èˆ¹\nâ€¢ è™ä¸˜ - å´ä¸­ç¬¬ä¸€åèƒœ\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\næ¾é¼ æ¡‚é±¼ã€å¤ªæ¹–ä¸‰ç™½ã€è‹å¼æœˆé¥¼ã€ç¢§èºæ˜¥èŒ¶\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ4-5æœˆå’Œ9-10æœˆ' },
                            { id: 12, name: 'å¼ å®¶ç•Œ', icon: 'ğŸŒ²', desc: 'å¤©é—¨å±±ã€ç»ç’ƒæ ˆé“ã€é»„é¾™æ´',
                              details: 'ğŸŒ² **å¼ å®¶ç•Œ** - ç¼©å°ç‰ˆä»™å¢ƒ\n\nğŸ“ å¿…æ¸¸æ™¯ç‚¹ï¼š\nâ€¢ å¤©é—¨å±± - ä¸–ç•Œæœ€é•¿ç´¢é“\nâ€¢ ç»ç’ƒæ ˆé“ - æ‚¬å´–ä¸Šçš„å¿ƒè·³\nâ€¢ é»„é¾™æ´ - åœ°ä¸‹æ˜ç \nâ€¢ è¢å®¶ç•Œ - é˜¿å‡¡è¾¾å–æ™¯åœ°\nâ€¢ é‡‘é­æºª - å¤©ä¸‹æœ€ç¾æºªæµ\n\nğŸœ ç‰¹è‰²ç¾é£Ÿï¼š\nä¸‰ä¸‹é”…ã€è‘›æ ¹ç²‰ã€åœŸå®¶è…Šè‚‰ã€å²©è€³ç‚–é¸¡\n\nğŸ“… æœ€ä½³æ—…æ¸¸æ—¶é—´ï¼š\næ˜¥ç§‹ä¸¤å­£ï¼Œ9-11æœˆæœ€ç¾' }
                        ]
                    };
                }
                // ç¡®ä¿visitedCitieså­˜åœ¨ï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰
                if (data.travel && !data.travel.visitedCities) {
                    data.travel.visitedCities = [];
                }
            }

            // ç¡®ä¿æµ‹è¯•æ•°æ®å­˜åœ¨
            if (!data.tests) {
                data.tests = {
                    records: [],
                    totalPoints: 0
                };
            }

            // ç¡®ä¿è¿åŠ¨æ•°æ®å­˜åœ¨
            if (!data.sports) {
                data.sports = {
                    badminton: { records: [], totalMinutes: 0, totalPoints: 0 },
                    outdoor: { records: [], totalMinutes: 0, totalPoints: 0 }
                };
            }
            // å…¼å®¹æ—§æ•°æ® - å¦‚æœæœ‰tennisæ•°æ®ï¼Œè¿ç§»åˆ°outdoor
            if (data.sports.tennis && !data.sports.outdoor) {
                data.sports.outdoor = data.sports.tennis;
                delete data.sports.tennis;
            }

            // ç¡®ä¿å®¶åŠ¡æ•°æ®å­˜åœ¨
            if (!data.chores) {
                data.chores = {
                    records: [],
                    totalCount: 0,
                    totalPoints: 0
                };
            }

            // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œåˆå§‹åŒ–é»˜è®¤ä½œæ¯è¡¨
            if (!data.schedule || data.schedule.length === 0) {
                data.schedule = [
                    { id: Date.now() + 1, time: '07:00', activity: 'èµ·åºŠæ´—æ¼±', completed: false },
                    { id: Date.now() + 2, time: '07:30', activity: 'æ—©é¤', completed: false },
                    { id: Date.now() + 3, time: '08:00', activity: 'æ™¨è¯»/èƒŒå•è¯', completed: false },
                    { id: Date.now() + 4, time: '09:00', activity: 'ä½œä¸šæ—¶é—´ï¼ˆæ•°å­¦ï¼‰', completed: false },
                    { id: Date.now() + 5, time: '10:30', activity: 'ä¼‘æ¯/è¿åŠ¨', completed: false },
                    { id: Date.now() + 6, time: '11:00', activity: 'ä½œä¸šæ—¶é—´ï¼ˆè¯­æ–‡ï¼‰', completed: false },
                    { id: Date.now() + 7, time: '12:00', activity: 'åˆé¤', completed: false },
                    { id: Date.now() + 8, time: '13:00', activity: 'åˆä¼‘', completed: false },
                    { id: Date.now() + 9, time: '14:00', activity: 'é˜…è¯»æ—¶é—´', completed: false },
                    { id: Date.now() + 10, time: '15:30', activity: 'ä½œä¸šæ—¶é—´ï¼ˆè‹±è¯­ï¼‰', completed: false },
                    { id: Date.now() + 11, time: '17:00', activity: 'è‡ªç”±æ´»åŠ¨', completed: false },
                    { id: Date.now() + 12, time: '18:00', activity: 'æ™šé¤', completed: false },
                    { id: Date.now() + 13, time: '19:00', activity: 'å¤ä¹ /é¢„ä¹ ', completed: false },
                    { id: Date.now() + 14, time: '20:00', activity: 'æ¸¸æˆ/å¨±ä¹æ—¶é—´', completed: false },
                    { id: Date.now() + 15, time: '21:00', activity: 'æ´—æ¼±å‡†å¤‡ç¡è§‰', completed: false },
                    { id: Date.now() + 16, time: '21:30', activity: 'ç¡è§‰', completed: false }
                ];
                saveData();
            }

            // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°çš„ä¸€å¤©
            const today = new Date().toDateString();
            if (data.lastVisit !== today) {
                data.studyDays++;
                data.lastVisit = today;
                // é‡ç½®ä½œæ¯è¡¨çš„å®ŒæˆçŠ¶æ€
                data.schedule.forEach(item => item.completed = false);
                saveData();
            }

            // é‡ç½®æ¯æ—¥ç•ªèŒ„é’Ÿè®¡æ•°
            if (data.pomodoros.lastDate !== today) {
                data.pomodoros.today = 0;
                data.pomodoros.lastDate = today;
                saveData();
            }
        }

        // ä¿å­˜æ•°æ®
        function saveData() {
            localStorage.setItem('winterStudyData', JSON.stringify(data));
        }

        // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
        function updateDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('dateInfo').textContent = now.toLocaleDateString('zh-CN', options);
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // æ›´æ–°æ€»è§ˆé¡µé¢
        function updateDashboard() {
            const pendingHomework = data.homework.filter(h => !h.completed).length;
            document.getElementById('totalHomework').textContent = pendingHomework;
            document.getElementById('totalBooks').textContent = data.books.length;
            document.getElementById('studyDays').textContent = data.studyDays;
            document.getElementById('completedTasks').textContent = data.completedTasks;
            document.getElementById('totalPoints').textContent = data.points.total;

            // æ›´æ–°ä½œæ¯å®Œæˆæƒ…å†µ
            const totalSchedule = data.schedule.length;
            const completedSchedule = data.schedule.filter(s => s.completed).length;
            const scheduleRate = totalSchedule > 0 ? Math.round((completedSchedule / totalSchedule) * 100) : 0;

            document.getElementById('completedSchedule').textContent = completedSchedule;
            document.getElementById('totalSchedule').textContent = totalSchedule;
            document.getElementById('scheduleRate').textContent = scheduleRate;
            document.getElementById('scheduleProgressBar').style.width = scheduleRate + '%';
            document.getElementById('scheduleProgressBar').textContent = scheduleRate + '%';

            // æ ¹æ®å®Œæˆç‡æ˜¾ç¤ºä¸åŒçš„emoji
            let emoji = 'ğŸ“‹';
            if (scheduleRate === 100) {
                emoji = 'ğŸ‰';
            } else if (scheduleRate >= 80) {
                emoji = 'ğŸ˜Š';
            } else if (scheduleRate >= 50) {
                emoji = 'ğŸ’ª';
            } else if (scheduleRate > 0) {
                emoji = 'ğŸ“';
            }
            document.getElementById('scheduleEmoji').textContent = emoji;

            // ä»Šæ—¥ä»»åŠ¡
            const todayTasks = document.getElementById('todayTasks');
            const today = new Date().toDateString();
            const todayHomework = data.homework.filter(h => {
                return !h.completed && new Date(h.deadline).toDateString() === today;
            });

            if (todayHomework.length === 0) {
                todayTasks.innerHTML = '<div class="empty-state"><div class="empty-state-icon">âœ…</div><p>ä»Šå¤©æ²¡æœ‰å¾…å®Œæˆçš„ä½œä¸š</p></div>';
            } else {
                todayTasks.innerHTML = todayHomework.map(h => `
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">${h.subject} - ${h.title}</span>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-success btn-small" onclick="completeHomework(${h.id})">å®Œæˆ</button>
                        </div>
                    </div>
                `).join('');
            }

            // é˜…è¯»è¿›åº¦
            const readingProgress = document.getElementById('readingProgress');
            if (data.books.length === 0) {
                readingProgress.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“š</div><p>è¿˜æ²¡æœ‰æ·»åŠ ä¹¦ç±</p></div>';
            } else {
                readingProgress.innerHTML = data.books.slice(0, 3).map(book => {
                    const progress = (book.currentPage / book.totalPages * 100).toFixed(1);
                    return `
                        <div class="book-item">
                            <div class="book-info">
                                <div class="book-title">${book.title}</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${progress}%">${progress}%</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        // ä½œä¸šç®¡ç†
        function addHomework() {
            const title = document.getElementById('homeworkTitle').value.trim();
            const subject = document.getElementById('homeworkSubject').value;
            const desc = document.getElementById('homeworkDesc').value.trim();
            const deadline = document.getElementById('homeworkDeadline').value;

            if (!title) {
                alert('è¯·è¾“å…¥ä½œä¸šæ ‡é¢˜');
                return;
            }

            if (!deadline) {
                alert('è¯·é€‰æ‹©æˆªæ­¢æ—¥æœŸ');
                return;
            }

            const homework = {
                id: Date.now(),
                title,
                subject,
                desc,
                deadline,
                completed: false,
                createdAt: new Date().toISOString()
            };

            data.homework.push(homework);
            saveData();
            renderHomework();
            updateDashboard();

            // æ¸…ç©ºè¾“å…¥
            document.getElementById('homeworkTitle').value = '';
            document.getElementById('homeworkDesc').value = '';
            document.getElementById('homeworkDeadline').value = '';
        }

        function renderHomework() {
            const list = document.getElementById('homeworkList');
            const pending = data.homework.filter(h => !h.completed);
            const completed = data.homework.filter(h => h.completed);

            if (data.homework.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“</div><p>è¿˜æ²¡æœ‰æ·»åŠ ä½œä¸š</p></div>';
                return;
            }

            let html = '';

            if (pending.length > 0) {
                html += '<h4 style="color: #667eea; margin-bottom: 15px;">å¾…å®Œæˆ</h4>';
                html += pending.map(h => `
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">${h.subject} - ${h.title}</span>
                            <span style="color: #dc3545;">ğŸ“… ${h.deadline}</span>
                        </div>
                        ${h.desc ? `<div class="card-content">${h.desc}</div>` : ''}
                        <div class="card-actions">
                            <button class="btn btn-success btn-small" onclick="completeHomework(${h.id})">å®Œæˆ</button>
                            <button class="btn btn-danger btn-small" onclick="deleteHomework(${h.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `).join('');
            }

            if (completed.length > 0) {
                html += '<h4 style="color: #28a745; margin: 20px 0 15px;">å·²å®Œæˆ</h4>';
                html += completed.map(h => `
                    <div class="card completed">
                        <div class="card-header">
                            <span class="card-title">âœ… ${h.subject} - ${h.title}</span>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-danger btn-small" onclick="deleteHomework(${h.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `).join('');
            }

            list.innerHTML = html;
        }

        function completeHomework(id) {
            const homework = data.homework.find(h => h.id === id);
            if (homework) {
                homework.completed = true;
                data.completedTasks++;
                // æ¯å¤©æ¯é¡¹ä½œä¸šé™åˆ¶ä¸€æ¬¡ç§¯åˆ†
                const today = new Date().toLocaleDateString('zh-CN');
                const earned = addPoints(10, `å®Œæˆä½œä¸š: ${homework.title}`, true);
                saveData();
                renderHomework();
                updateDashboard();
                if (earned) {
                    showPointsNotification('+10 ç§¯åˆ†');
                    showToast(`ğŸ‰ å®Œæˆã€Š${homework.title}ã€‹ï¼Œè·å¾— +10 ç§¯åˆ†ï¼`);
                } else {
                    showToast(`ğŸ“ ã€Š${homework.title}ã€‹ä»Šå¤©å·²è·å–è¿‡ç§¯åˆ†å•¦ï¼`);
                }
            }
        }

        function deleteHomework(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œä¸šå—ï¼Ÿ')) {
                data.homework = data.homework.filter(h => h.id !== id);
                saveData();
                renderHomework();
                updateDashboard();
            }
        }

        // é˜…è¯»ç®¡ç†
        function addBook() {
            const title = document.getElementById('bookTitle').value.trim();
            const author = document.getElementById('bookAuthor').value.trim();
            const category = document.getElementById('bookCategory').value;
            const totalPages = parseInt(document.getElementById('bookPages').value);
            const totalWords = parseInt(document.getElementById('bookWords').value) || 0;

            if (!title) {
                alert('è¯·è¾“å…¥ä¹¦å');
                return;
            }

            if (!totalPages || totalPages < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ€»é¡µæ•°');
                return;
            }

            const book = {
                id: Date.now(),
                title,
                author: author || 'æœªçŸ¥ä½œè€…',
                category: category,
                totalPages,
                totalWords,
                currentPage: 0,
                createdAt: new Date().toISOString()
            };

            data.books.push(book);
            saveData();
            renderBooks();
            updateDashboard();

            // æ¸…ç©ºè¾“å…¥
            document.getElementById('bookTitle').value = '';
            document.getElementById('bookAuthor').value = '';
            document.getElementById('bookPages').value = '';
            document.getElementById('bookWords').value = '';
        }

        function renderBooks() {
            const list = document.getElementById('bookList');

            if (data.books.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“š</div><p>è¿˜æ²¡æœ‰æ·»åŠ ä¹¦ç±ï¼Œå¿«æ¥æ·»åŠ ä½ çš„å¯’å‡ä¹¦å•å§ï¼</p></div>';
                return;
            }

            list.innerHTML = data.books.map(book => {
                const progress = (book.currentPage / book.totalPages * 100).toFixed(1);
                const isCompleted = book.currentPage >= book.totalPages;

                // ç±»åˆ«æ ‡ç­¾æ ·å¼
                const categoryBadge = book.category && book.category !== 'å›¾ä¹¦' ?
                    `<span class="category-badge">${book.category}</span>` : '';

                // è®¡ç®—å·²è¯»å­—æ•°
                let wordInfo = '';
                if (book.totalWords && book.totalWords > 0) {
                    const currentWords = Math.floor((book.currentPage / book.totalPages) * book.totalWords);
                    wordInfo = `<div style="font-size: 14px; color: #666; margin-top: 5px;">
                        å·²è¯»å­—æ•°: ${currentWords.toLocaleString()} / ${book.totalWords.toLocaleString()} å­—
                    </div>`;
                }

                return `
                    <div class="card ${isCompleted ? 'completed' : ''}">
                        <div class="card-header">
                            <div>
                                <div class="card-title">${isCompleted ? 'âœ… ' : ''}${book.title} ${categoryBadge}</div>
                                <div style="color: #666; font-size: 14px;">ä½œè€…: ${book.author || 'æœªçŸ¥'}</div>
                                ${wordInfo}
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 14px; color: #666;">
                                    ${book.currentPage} / ${book.totalPages} é¡µ
                                </div>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%">${progress}%</div>
                        </div>
                        <div class="card-actions">
                            <input type="number" id="page-${book.id}" placeholder="å½“å‰é¡µæ•°"
                                   min="0" max="${book.totalPages}" value="${book.currentPage}"
                                   style="width: 120px; padding: 6px; border: 2px solid #dee2e6; border-radius: 5px;">
                            <button class="btn btn-success btn-small" onclick="updateBookProgress(${book.id})">æ›´æ–°è¿›åº¦</button>
                            <button class="btn btn-danger btn-small" onclick="deleteBook(${book.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateBookProgress(id) {
            const book = data.books.find(b => b.id === id);
            const newPage = parseInt(document.getElementById(`page-${id}`).value);

            if (book && newPage >= 0 && newPage <= book.totalPages) {
                const wasCompleted = book.currentPage >= book.totalPages;
                book.currentPage = newPage;
                const isNowCompleted = book.currentPage >= book.totalPages;

                // å¦‚æœåˆšåˆšå®Œæˆé˜…è¯»ï¼Œç»™äºˆ20ç§¯åˆ†ï¼ˆä¸€æ¬¡æ€§å¥–åŠ±ï¼‰
                if (!wasCompleted && isNowCompleted) {
                    addPoints(20, 'è¯»å®Œä¹¦ç±: ' + book.title, false);
                    showPointsNotification('+20 ç§¯åˆ† - è¯»å®Œä¸€æœ¬ä¹¦ï¼');
                    showToast(`ğŸ‰ æ­å–œè¯»å®Œã€Š${book.title}ã€‹ï¼Œè·å¾— +20 ç§¯åˆ†ï¼`);
                } else {
                    // æ›´æ–°è¿›åº¦ç»™äºˆ2ç§¯åˆ†ï¼ˆæ¯å¤©æ¯æœ¬ä¹¦é™åˆ¶ä¸€æ¬¡ï¼‰
                    const earned = addPoints(2, `é˜…è¯»è¿›åº¦: ${book.title}`, true);
                    if (earned) {
                        showPointsNotification('+2 ç§¯åˆ†');
                        showToast(`ğŸ“– é˜…è¯»è¿›åº¦å·²æ›´æ–°ï¼Œè·å¾— +2 ç§¯åˆ†ï¼`);
                    } else {
                        showToast(`ğŸ“– ã€Š${book.title}ã€‹ä»Šå¤©å·²è·å–è¿‡ç§¯åˆ†å•¦ï¼`);
                    }
                }

                saveData();
                renderBooks();
                updateDashboard();
            } else {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é¡µæ•°');
            }
        }

        function deleteBook(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦å—ï¼Ÿ')) {
                data.books = data.books.filter(b => b.id !== id);
                saveData();
                renderBooks();
                updateDashboard();
            }
        }

        // å­¦ä¹ è®¡åˆ’ç®¡ç†
        function addPlan() {
            const title = document.getElementById('planTitle').value.trim();
            const type = document.getElementById('planType').value;

            if (!title) {
                alert('è¯·è¾“å…¥è®¡åˆ’æ ‡é¢˜');
                return;
            }

            const plan = {
                id: Date.now(),
                title,
                type,
                completed: false,
                createdAt: new Date().toISOString()
            };

            data.plans.push(plan);
            saveData();
            renderPlans();

            document.getElementById('planTitle').value = '';
        }

        function renderPlans() {
            const list = document.getElementById('planList');

            if (data.plans.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“…</div><p>è¿˜æ²¡æœ‰åˆ¶å®šå­¦ä¹ è®¡åˆ’</p></div>';
                return;
            }

            const pending = data.plans.filter(p => !p.completed);
            const completed = data.plans.filter(p => p.completed);

            let html = '';

            if (pending.length > 0) {
                html += '<h4 style="color: #667eea; margin-bottom: 15px;">è¿›è¡Œä¸­</h4>';
                html += pending.map(p => {
                    const typeLabel = {daily: 'æ¯æ—¥', weekly: 'æ¯å‘¨', custom: 'è‡ªå®šä¹‰'}[p.type];
                    return `
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">${p.title}</span>
                                <span style="background: #667eea; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px;">
                                    ${typeLabel}
                                </span>
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-success btn-small" onclick="completePlan(${p.id})">å®Œæˆ</button>
                                <button class="btn btn-danger btn-small" onclick="deletePlan(${p.id})">åˆ é™¤</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            if (completed.length > 0) {
                html += '<h4 style="color: #28a745; margin: 20px 0 15px;">å·²å®Œæˆ</h4>';
                html += completed.map(p => `
                    <div class="card completed">
                        <div class="card-header">
                            <span class="card-title">âœ… ${p.title}</span>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-danger btn-small" onclick="deletePlan(${p.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `).join('');
            }

            list.innerHTML = html;
        }

        function completePlan(id) {
            const plan = data.plans.find(p => p.id === id);
            if (plan) {
                plan.completed = true;
                data.completedTasks++;
                // æ¯å¤©æ¯é¡¹è®¡åˆ’é™åˆ¶ä¸€æ¬¡ç§¯åˆ†
                const earned = addPoints(8, `å®Œæˆè®¡åˆ’: ${plan.title}`, true);
                saveData();
                renderPlans();
                updateDashboard();
                if (earned) {
                    showPointsNotification('+8 ç§¯åˆ†');
                    showToast(`ğŸ¯ å®Œæˆã€Š${plan.title}ã€‹ï¼Œè·å¾— +8 ç§¯åˆ†ï¼`);
                } else {
                    showToast(`ğŸ“ ã€Š${plan.title}ã€‹ä»Šå¤©å·²è·å–è¿‡ç§¯åˆ†å•¦ï¼`);
                }
            }
        }

        function deletePlan(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè®¡åˆ’å—ï¼Ÿ')) {
                data.plans = data.plans.filter(p => p.id !== id);
                saveData();
                renderPlans();
            }
        }

        // æ‰“å¼€æ³¨æ„åŠ›è®­ç»ƒ
        function openTraining() {
            window.open('attention-training.html', '_blank');
        }

        // ç•ªèŒ„é’ŸåŠŸèƒ½
        function updatePomodoroDisplay() {
            const minutes = Math.floor(pomodoroSeconds / 60);
            const seconds = pomodoroSeconds % 60;
            document.getElementById('pomodoroTimer').textContent =
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function updatePomodoroStats() {
            document.getElementById('todayPomodoros').textContent = data.pomodoros.today;
            document.getElementById('totalStudyTime').textContent = data.pomodoros.totalTime;
        }

        function startPomodoro() {
            if (pomodoroRunning) return;

            pomodoroRunning = true;
            document.getElementById('pomodoroStatus').textContent =
                pomodoroMode === 'work' ? 'ğŸ¯ ä¸“æ³¨å­¦ä¹ ä¸­...' : 'â˜• ä¼‘æ¯æ—¶é—´';

            pomodoroTimer = setInterval(() => {
                pomodoroSeconds--;
                updatePomodoroDisplay();

                if (pomodoroSeconds <= 0) {
                    clearInterval(pomodoroTimer);
                    pomodoroRunning = false;
                    completePomodoroSession();
                }
            }, 1000);
        }

        function pausePomodoro() {
            if (pomodoroTimer) {
                clearInterval(pomodoroTimer);
                pomodoroRunning = false;
                document.getElementById('pomodoroStatus').textContent = 'â¸ï¸ å·²æš‚åœ';
            }
        }

        function resetPomodoro() {
            if (pomodoroTimer) {
                clearInterval(pomodoroTimer);
            }
            pomodoroRunning = false;
            pomodoroMode = 'work';
            pomodoroSeconds = 25 * 60;
            updatePomodoroDisplay();
            document.getElementById('pomodoroStatus').textContent = 'å‡†å¤‡å¼€å§‹å­¦ä¹ ';
        }

        function completePomodoroSession() {
            // æ’­æ”¾æç¤ºéŸ³ï¼ˆä½¿ç”¨Web Audio APIï¼‰
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);

            if (pomodoroMode === 'work') {
                // å®Œæˆä¸€ä¸ªå·¥ä½œç•ªèŒ„é’Ÿ
                data.pomodoros.today++;
                data.pomodoros.totalTime += 25;
                // æ¯å¤©ç¬¬ä¸€ä¸ªç•ªèŒ„é’Ÿç»™5åˆ†
                const earned = addPoints(5, 'å®Œæˆç•ªèŒ„é’Ÿ', true);
                saveData();
                updatePomodoroStats();
                if (earned) {
                    showPointsNotification('+5 ç§¯åˆ†');
                    alert('ğŸ‰ å¤ªæ£’äº†ï¼å®Œæˆäº†ä¸€ä¸ªç•ªèŒ„é’Ÿï¼\nè·å¾— +5 ç§¯åˆ†\nç°åœ¨ä¼‘æ¯5åˆ†é’Ÿå§~');
                } else {
                    alert('ğŸ‰ å®Œæˆäº†ä¸€ä¸ªç•ªèŒ„é’Ÿï¼\nä»Šå¤©å·²è·å–è¿‡ç•ªèŒ„é’Ÿç§¯åˆ†å•¦ï¼Œç»§ç»­åŠ æ²¹ï¼');
                }
                pomodoroMode = 'break';
                pomodoroSeconds = 5 * 60;
                document.getElementById('pomodoroStatus').textContent = 'â˜• å‡†å¤‡ä¼‘æ¯';
            } else {
                // å®Œæˆä¼‘æ¯
                alert('â° ä¼‘æ¯ç»“æŸï¼å‡†å¤‡å¼€å§‹ä¸‹ä¸€ä¸ªç•ªèŒ„é’Ÿå§ï¼');
                pomodoroMode = 'work';
                pomodoroSeconds = 25 * 60;
                document.getElementById('pomodoroStatus').textContent = 'å‡†å¤‡å¼€å§‹å­¦ä¹ ';
            }
            updatePomodoroDisplay();
        }

        // ç§¯åˆ†ç³»ç»ŸåŠŸèƒ½
        function addPoints(amount, reason, checkDailyLimit = true) {
            // æ£€æŸ¥æ¯æ—¥é™åˆ¶ï¼ˆé»˜è®¤å¼€å¯ï¼‰
            if (checkDailyLimit) {
                const today = new Date().toLocaleDateString('zh-CN');
                if (!data.dailyTasks) {
                    data.dailyTasks = {};
                }
                if (!data.dailyTasks[today]) {
                    data.dailyTasks[today] = [];
                }

                // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²ç»å®Œæˆè¿‡è¿™ä¸ªä»»åŠ¡
                if (data.dailyTasks[today].includes(reason)) {
                    return false; // ä»Šå¤©å·²ç»è·å–è¿‡ç§¯åˆ†
                }

                // è®°å½•ä»Šå¤©çš„ä»»åŠ¡
                data.dailyTasks[today].push(reason);
            }

            data.points.total += amount;
            data.points.history.unshift({
                amount: amount,
                reason: reason,
                timestamp: new Date().toISOString(),
                type: 'earn'
            });
            // åªä¿ç•™æœ€è¿‘50æ¡è®°å½•
            if (data.points.history.length > 50) {
                data.points.history = data.points.history.slice(0, 50);
            }
            updatePointsDisplay();
            return true;
        }

        function deductPoints(amount, reason) {
            if (data.points.total >= amount) {
                data.points.total -= amount;
                data.points.history.unshift({
                    amount: -amount,
                    reason: reason,
                    timestamp: new Date().toISOString(),
                    type: 'redeem'
                });
                if (data.points.history.length > 50) {
                    data.points.history = data.points.history.slice(0, 50);
                }
                updatePointsDisplay();
                return true;
            }
            return false;
        }

        function updatePointsDisplay() {
            document.getElementById('headerPoints').textContent = data.points.total;
            document.getElementById('currentPoints').textContent = data.points.total;
        }

        function showPointsNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'achievement-badge';
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '100px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        function renderPointsHistory() {
            const container = document.getElementById('pointsHistory');
            if (!data.points.history || data.points.history.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“œ</div><p>è¿˜æ²¡æœ‰ç§¯åˆ†è®°å½•</p></div>';
                return;
            }

            container.innerHTML = data.points.history.map(record => {
                const date = new Date(record.timestamp);
                const dateStr = date.toLocaleDateString('zh-CN') + ' ' + date.toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'});
                const isPositive = record.amount > 0;

                return `
                    <div class="history-item ${isPositive ? '' : 'negative'}">
                        <div>
                            <div style="font-weight: bold; margin-bottom: 5px;">${record.reason}</div>
                            <div style="font-size: 12px; color: #999;">${dateStr}</div>
                        </div>
                        <div class="history-points ${isPositive ? 'positive' : 'negative'}">
                            ${isPositive ? '+' : ''}${record.amount}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function redeemReward(type, cost, value) {
            if (data.points.total < cost) {
                alert('ç§¯åˆ†ä¸è¶³ï¼è¿˜éœ€è¦ ' + (cost - data.points.total) + ' ç§¯åˆ†');
                return;
            }

            let message = '';
            if (type === 'money') {
                message = `ç¡®å®šè¦å…‘æ¢ ${value} å…ƒé›¶èŠ±é’±å—ï¼Ÿ\nå°†æ¶ˆè€— ${cost} ç§¯åˆ†`;
            } else if (type === 'game') {
                message = `ç¡®å®šè¦å…‘æ¢ ${value} åˆ†é’Ÿæ¸¸æˆæ—¶é—´å—ï¼Ÿ\nå°†æ¶ˆè€— ${cost} ç§¯åˆ†`;
            }

            if (confirm(message)) {
                const reason = type === 'money' ? `å…‘æ¢é›¶èŠ±é’± ${value}å…ƒ` : `å…‘æ¢æ¸¸æˆæ—¶é—´ ${value}åˆ†é’Ÿ`;
                if (deductPoints(cost, reason)) {
                    saveData();
                    renderPointsHistory();
                    alert(`ğŸ‰ å…‘æ¢æˆåŠŸï¼\n${reason}\nå‰©ä½™ç§¯åˆ†: ${data.points.total}`);
                }
            }
        }

        // ä½œæ¯è¡¨åŠŸèƒ½
        function addScheduleItem() {
            const time = document.getElementById('scheduleTime').value;
            const activity = document.getElementById('scheduleActivity').value.trim();

            if (!time || !activity) {
                alert('è¯·è¾“å…¥æ—¶é—´å’Œæ´»åŠ¨å†…å®¹');
                return;
            }

            const scheduleItem = {
                id: Date.now(),
                time: time,
                activity: activity,
                completed: false
            };

            data.schedule.push(scheduleItem);
            // æŒ‰æ—¶é—´æ’åº
            data.schedule.sort((a, b) => a.time.localeCompare(b.time));
            saveData();
            renderSchedule();

            // æ¸…ç©ºè¾“å…¥
            document.getElementById('scheduleActivity').value = '';
        }

        function renderSchedule() {
            const list = document.getElementById('scheduleList');

            if (data.schedule.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">è¿˜æ²¡æœ‰æ·»åŠ ä½œæ¯å®‰æ’ï¼Œç‚¹å‡»ä¸Šæ–¹æ·»åŠ æŒ‰é’®å¼€å§‹è§„åˆ’ä½ çš„ä¸€å¤©å§ï¼</div>';
                return;
            }

            list.innerHTML = data.schedule.map(item => `
                <div class="schedule-item ${item.completed ? 'completed' : ''}">
                    <div class="schedule-time">${item.time}</div>
                    <div class="schedule-activity">${item.activity}</div>
                    <div class="schedule-actions">
                        <div class="schedule-check ${item.completed ? 'checked' : ''}"
                             onclick="toggleScheduleItem(${item.id})"></div>
                        <button class="btn btn-danger btn-small" onclick="deleteScheduleItem(${item.id})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        function toggleScheduleItem(id) {
            const item = data.schedule.find(s => s.id === id);
            if (item) {
                const wasCompleted = item.completed;
                item.completed = !item.completed;

                // å¦‚æœä»æœªå®Œæˆå˜ä¸ºå®Œæˆï¼Œç»™äºˆç§¯åˆ†å¥–åŠ±ï¼ˆæ¯æ—¥æ¯é¡¹é™åˆ¶ï¼‰
                if (!wasCompleted && item.completed) {
                    const earned = addPoints(1, `å®Œæˆä½œæ¯: ${item.time} ${item.activity}`, true);
                    if (earned) {
                        showPointsNotification('+1 ç§¯åˆ†');
                    } else {
                        showToast(`ğŸ“ ${item.activity} ä»Šå¤©å·²è·å–è¿‡ç§¯åˆ†å•¦ï¼`);
                    }
                }

                saveData();
                renderSchedule();
                updateDashboard();
            }
        }

        function deleteScheduleItem(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œæ¯é¡¹å—ï¼Ÿ')) {
                data.schedule = data.schedule.filter(s => s.id !== id);
                saveData();
                renderSchedule();
            }
        }

        // æ¢ç´¢ä¸–ç•ŒåŠŸèƒ½
        function renderCities() {
            const grid = document.getElementById('citiesGrid');
            if (!grid) return;

            document.getElementById('unlockedCities').textContent = data.travel.unlockedCities.length;
            document.getElementById('travelPoints').textContent = data.points.total;

            grid.innerHTML = data.travel.cities.map(city => {
                const isUnlocked = data.travel.unlockedCities.includes(city.id);
                const isVisited = data.travel.visitedCities.includes(city.id);
                return `
                    <div class="city-card ${isUnlocked ? 'unlocked' : ''} ${isVisited ? 'visited' : ''}">
                        <div class="city-icon">${city.icon}</div>
                        <div class="city-name">${city.name}</div>
                        <div class="city-desc">${city.desc}</div>
                        <div class="city-status ${isUnlocked ? 'unlocked' : 'locked'}">
                            ${isUnlocked ? 'âœ… å·²è§£é”' : 'ğŸ”’ æœªè§£é”'}
                        </div>
                        <div class="city-card-buttons">
                            <button class="city-detail-btn" onclick="showCityDetails(${city.id})">
                                ğŸ“– æŸ¥çœ‹è¯¦æƒ…
                            </button>
                            ${isUnlocked ? `
                                <button class="visit-toggle-btn ${isVisited ? 'visited' : ''}"
                                        onclick="toggleVisited(${city.id})">
                                    ${isVisited ? 'âœˆï¸ å·²å»è¿‡' : 'ğŸ“… æ ‡è®°å»è¿‡'}
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // åˆ‡æ¢åŸå¸‚è®¿é—®çŠ¶æ€
        function toggleVisited(cityId) {
            const index = data.travel.visitedCities.indexOf(cityId);
            if (index > -1) {
                data.travel.visitedCities.splice(index, 1);
            } else {
                data.travel.visitedCities.push(cityId);
            }
            saveData();
            renderCities();
        }

        // æ˜¾ç¤ºåŸå¸‚è¯¦æƒ…
        function showCityDetails(cityId) {
            const city = data.travel.cities.find(c => c.id === cityId);
            if (!city) return;

            // å…¼å®¹æ—§æ•°æ® - å¦‚æœæ²¡æœ‰è¯¦æƒ…ï¼Œä½¿ç”¨é»˜è®¤å†…å®¹
            const cityDetails = city.details || `${city.icon} **${city.name}**

ğŸ“ ç®€ä»‹ï¼š
${city.desc}

è¿™æ˜¯ä¸€ä¸ªç¾ä¸½çš„ä¸­å›½æ—…æ¸¸åŸå¸‚ï¼Œç­‰ä½ æ¥æ¢ç´¢ï¼

ğŸ“ è§£é”åå¯ä»¥æ ‡è®°"å»è¿‡"çŠ¶æ€ï¼Œè®°å½•ä½ çš„æ—…è¡Œè¶³è¿¹ã€‚`;

            const isUnlocked = data.travel.unlockedCities.includes(cityId);
            const isVisited = data.travel.visitedCities.includes(cityId);

            // åˆ›å»ºè¯¦æƒ…å¼¹çª—
            const modal = document.createElement('div');
            modal.className = 'city-detail-modal';
            modal.innerHTML = `
                <div class="city-detail-content" onclick="event.stopPropagation()">
                    <button class="city-detail-close" onclick="closeCityDetails()">Ã—</button>
                    <div class="city-detail-header">
                        <span class="city-detail-icon">${city.icon}</span>
                        <h2>${city.name}</h2>
                        ${isUnlocked ? `
                            <span class="city-badge unlocked-badge">å·²è§£é”</span>
                            ${isVisited ? '<span class="city-badge visited-badge">âœˆï¸ å·²å»è¿‡</span>' : '<span class="city-badge not-visited-badge">ğŸ“… æœªå»è¿‡</span>'}
                        ` : '<span class="city-badge locked-badge">ğŸ”’ æœªè§£é”</span>'}
                    </div>
                    <div class="city-detail-body">
                        <pre style="white-space: pre-wrap; font-family: inherit; line-height: 1.8;">${cityDetails}</pre>
                    </div>
                    ${isUnlocked ? `
                        <div class="city-detail-footer">
                            <button class="visit-action-btn ${isVisited ? 'visited' : ''}"
                                    onclick="toggleVisitedFromModal(${cityId}); closeCityDetails();">
                                ${isVisited ? 'âœ• å–æ¶ˆå»è¿‡æ ‡è®°' : 'âœ“ æ ‡è®°ä¸ºå·²å»è¿‡'}
                            </button>
                        </div>
                    ` : `
                        <div class="city-detail-footer">
                            <button class="unlock-hint-btn">ğŸ’ éœ€è¦5000ç§¯åˆ†è§£é”</button>
                        </div>
                    `}
                </div>
            `;
            modal.onclick = closeCityDetails;
            document.body.appendChild(modal);
        }

        // ä»å¼¹çª—åˆ‡æ¢è®¿é—®çŠ¶æ€
        function toggleVisitedFromModal(cityId) {
            const index = data.travel.visitedCities.indexOf(cityId);
            if (index > -1) {
                data.travel.visitedCities.splice(index, 1);
            } else {
                data.travel.visitedCities.push(cityId);
            }
            saveData();
            renderCities();
        }

        // å…³é—­åŸå¸‚è¯¦æƒ…
        function closeCityDetails() {
            const modal = document.querySelector('.city-detail-modal');
            if (modal) {
                modal.remove();
            }
        }

        function redeemTravel() {
            const cost = 5000;
            if (data.points.total < cost) {
                alert(`ç§¯åˆ†ä¸è¶³ï¼è¿˜éœ€è¦ ${cost - data.points.total} ç§¯åˆ†\n\nğŸ’¡ ç»§ç»­åŠªåŠ›å­¦ä¹ å§ï¼`);
                return;
            }

            // è·å–æœªè§£é”çš„åŸå¸‚
            const lockedCities = data.travel.cities.filter(city =>
                !data.travel.unlockedCities.includes(city.id)
            );

            if (lockedCities.length === 0) {
                alert('ğŸ‰ æ­å–œï¼ä½ å·²ç»è§£é”äº†æ‰€æœ‰åŸå¸‚ï¼');
                return;
            }

            // åˆ›å»ºåŸå¸‚é€‰æ‹©å¯¹è¯æ¡†
            let cityOptions = lockedCities.map((city, index) =>
                `${index + 1}. ${city.icon} ${city.name} - ${city.desc}`
            ).join('\n');

            let message = `ğŸ‰ æ­å–œï¼ä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªåŸå¸‚è§£é”ï¼\n\n${cityOptions}\n\nè¯·è¾“å…¥åŸå¸‚ç¼–å·ï¼ˆ1-${lockedCities.length}ï¼‰ï¼š`;
            let choice = prompt(message);

            if (choice) {
                const index = parseInt(choice) - 1;
                if (index >= 0 && index < lockedCities.length) {
                    const selectedCity = lockedCities[index];

                    if (confirm(`ç¡®å®šè¦è§£é” ${selectedCity.icon} ${selectedCity.name} å—ï¼Ÿ\nå°†æ¶ˆè€— ${cost} ç§¯åˆ†`)) {
                        data.travel.unlockedCities.push(selectedCity.id);
                        deductPoints(cost, `è§£é”æ—…æ¸¸åŸå¸‚: ${selectedCity.name}`);
                        saveData();
                        renderCities();
                        renderPointsHistory();

                        alert(`ğŸŠ å¤ªæ£’äº†ï¼\n\nä½ æˆåŠŸè§£é”äº† ${selectedCity.icon} ${selectedCity.name}ï¼\n\n${selectedCity.desc}\n\nå’Œå®¶äººä¸€èµ·è®¡åˆ’è¿™æ¬¡æ—…è¡Œå§ï¼âœˆï¸`);
                    }
                } else {
                    alert('è¾“å…¥æ— æ•ˆï¼Œè¯·é‡è¯•');
                }
            }
        }

        // å­¦ä¹ æµ‹è¯•åŠŸèƒ½
        function startTest(subject) {
            const score = prompt(`ğŸ“‹ ${subject}æµ‹è¯•\n\nè¯·è¾“å…¥æœ¬æ¬¡æµ‹è¯•æˆç»©ï¼ˆ0-100åˆ†ï¼‰ï¼š`);

            if (score === null) return;

            const scoreNum = parseInt(score);
            if (isNaN(scoreNum) || scoreNum < 0 || scoreNum > 100) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„åˆ†æ•°ï¼ˆ0-100ï¼‰');
                return;
            }

            // è®¡ç®—ç§¯åˆ†å¥–åŠ±
            let points = 0;
            let level = '';
            if (scoreNum >= 90) {
                points = 30;
                level = 'excellent';
            } else if (scoreNum >= 80) {
                points = 20;
                level = 'good';
            } else if (scoreNum >= 60) {
                points = 10;
                level = 'good';
            } else {
                points = 5;
                level = 'poor';
            }

            // è®°å½•æµ‹è¯•
            const testRecord = {
                id: Date.now(),
                subject: subject,
                score: scoreNum,
                level: level,
                points: points,
                date: new Date().toISOString()
            };

            if (!data.tests) {
                data.tests = { records: [], totalPoints: 0 };
            }

            data.tests.records.unshift(testRecord);

            // æ·»åŠ ç§¯åˆ†ï¼ˆæ¯å¤©æ¯ä¸ªç§‘ç›®é™åˆ¶ä¸€æ¬¡ï¼‰
            const earned = addPoints(points, `${subject}æµ‹è¯•`, true);
            if (earned) {
                data.tests.totalPoints += points;
            }

            saveData();
            renderTestRecords();
            updateTestStats();

            // æ˜¾ç¤ºç»“æœ
            let message = '';
            if (scoreNum >= 90) {
                message = `ğŸ‰ ä¼˜ç§€ï¼\n\n${subject}æµ‹è¯•å¾—åˆ†ï¼š${scoreNum}åˆ†\nè·å¾—ç§¯åˆ†ï¼š+${points}\n\nç»§ç»­ä¿æŒï¼`;
            } else if (scoreNum >= 80) {
                message = `ğŸ‘ è‰¯å¥½ï¼\n\n${subject}æµ‹è¯•å¾—åˆ†ï¼š${scoreNum}åˆ†\nè·å¾—ç§¯åˆ†ï¼š+${points}\n\nå†æ¥å†å‰ï¼`;
            } else if (scoreNum >= 60) {
                message = `ğŸ’ª åŠæ ¼ï¼\n\n${subject}æµ‹è¯•å¾—åˆ†ï¼š${scoreNum}åˆ†\nè·å¾—ç§¯åˆ†ï¼š+${points}\n\nç»§ç»­åŠªåŠ›ï¼`;
            } else {
                message = `ğŸ“– éœ€è¦åŠ æ²¹ï¼\n\n${subject}æµ‹è¯•å¾—åˆ†ï¼š${scoreNum}åˆ†\nè·å¾—ç§¯åˆ†ï¼š+${points}\n\nå¤šå¤ä¹ ï¼Œä¸‹æ¬¡ä¼šæ›´å¥½ï¼`;
            }

            alert(message);
            showPointsNotification(`+${points} ç§¯åˆ†`);
        }

        function renderTestRecords() {
            const container = document.getElementById('testRecords');
            if (!container) return;

            if (!data.tests || !data.tests.records || data.tests.records.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“‹</div><p>è¿˜æ²¡æœ‰æµ‹è¯•è®°å½•ï¼Œå¿«å»å‚åŠ æµ‹è¯•å§ï¼</p></div>';
                return;
            }

            container.innerHTML = data.tests.records.map(record => {
                const date = new Date(record.date);
                const dateStr = date.toLocaleDateString('zh-CN') + ' ' + date.toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'});

                return `
                    <div class="test-record ${record.level}">
                        <div>
                            <div style="font-weight: bold; font-size: 18px; margin-bottom: 5px;">
                                ${record.subject}æµ‹è¯•
                            </div>
                            <div style="font-size: 14px; color: #666;">
                                ${dateStr} Â· è·å¾— ${record.points} ç§¯åˆ†
                            </div>
                        </div>
                        <div class="test-score ${record.level}">
                            ${record.score}åˆ†
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTestStats() {
            if (!data.tests || !data.tests.records) {
                data.tests = { records: [], totalPoints: 0 };
            }

            const totalTests = data.tests.records.length;
            const avgScore = totalTests > 0
                ? Math.round(data.tests.records.reduce((sum, r) => sum + r.score, 0) / totalTests)
                : 0;
            const excellentCount = data.tests.records.filter(r => r.score >= 90).length;

            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('avgScore').textContent = avgScore;
            document.getElementById('excellentCount').textContent = excellentCount;
            document.getElementById('testPoints').textContent = data.tests.totalPoints;
        }

        // è¿åŠ¨æå‡åŠŸèƒ½
        function addTraining(sport) {
            const sportNames = {
                'badminton': 'ç¾½æ¯›çƒ',
                'outdoor': 'æˆ·å¤–æ´»åŠ¨'
            };
            const sportName = sportNames[sport] || sport;

            const duration = parseInt(document.getElementById(`${sport}Duration`).value);
            let type = document.getElementById(`${sport}Type`).value;
            const note = document.getElementById(`${sport}Note`).value.trim();

            // å¤„ç†æˆ·å¤–æ´»åŠ¨çš„è‡ªå®šä¹‰ç±»å‹
            if (sport === 'outdoor') {
                if (type === 'è‡ªå®šä¹‰') {
                    const customValue = document.getElementById('outdoorCustom').value.trim();
                    type = customValue || 'è‡ªå®šä¹‰æ´»åŠ¨';
                }
            }

            if (!duration || duration < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ´»åŠ¨æ—¶é•¿');
                return;
            }

            // è®¡ç®—ç§¯åˆ†
            let points = 0;
            if (duration >= 90) {
                points = 20;
            } else if (duration >= 60) {
                points = 15;
            } else if (duration >= 30) {
                points = 10;
            } else {
                points = 5;
            }

            // åˆ›å»ºè®­ç»ƒè®°å½•
            const record = {
                id: Date.now(),
                type: type,
                duration: duration,
                note: note,
                points: points,
                date: new Date().toISOString()
            };

            // ä¿å­˜è®°å½•
            if (!data.sports[sport]) {
                data.sports[sport] = { records: [], totalMinutes: 0, totalPoints: 0 };
            }

            data.sports[sport].records.unshift(record);
            data.sports[sport].totalMinutes += duration;

            // æ·»åŠ ç§¯åˆ†ï¼ˆæ¯å¤©æ¯é¡¹è¿åŠ¨ç±»å‹é™åˆ¶ä¸€æ¬¡ï¼‰
            const earned = addPoints(points, `${sportName}-${type}`, true);
            if (earned) {
                data.sports[sport].totalPoints += points;
            }

            saveData();
            renderSportsRecords();
            updateSportsStats();
            updatePointsDisplay();
            renderPointsHistory();

            // æ¸…ç©ºè¾“å…¥
            document.getElementById(`${sport}Duration`).value = '';
            document.getElementById(`${sport}Note`).value = '';

            // æ˜¾ç¤ºæç¤º
            alert(`ğŸ‰ æ´»åŠ¨è®°å½•æˆåŠŸï¼\n\n${sportName} - ${type}\næ´»åŠ¨æ—¶é•¿ï¼š${duration}åˆ†é’Ÿ\nè·å¾—ç§¯åˆ†ï¼š+${points}\n\nç»§ç»­åŠ æ²¹ï¼ğŸ’ª`);
        }

        function renderSportsRecords() {
            // æ¸²æŸ“ç¾½æ¯›çƒè®°å½•
            renderSportRecords('badminton', 'ğŸ¸');
            // æ¸²æŸ“æˆ·å¤–æ´»åŠ¨è®°å½•
            renderSportRecords('outdoor', 'ğŸŒ³');
        }

        function renderSportRecords(sport, icon) {
            const container = document.getElementById(`${sport}Records`);
            if (!container) return;

            if (!data.sports || !data.sports[sport] || !data.sports[sport].records || data.sports[sport].records.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 15px; color: #999; font-size: 14px;">è¿˜æ²¡æœ‰è®­ç»ƒè®°å½•</div>';
                return;
            }

            // åªæ˜¾ç¤ºæœ€è¿‘5æ¡
            const recentRecords = data.sports[sport].records.slice(0, 5);

            container.innerHTML = recentRecords.map(record => {
                const date = new Date(record.date);
                const dateStr = date.toLocaleDateString('zh-CN', {month: 'numeric', day: 'numeric'});

                return `
                    <div class="training-record-item">
                        <div>
                            <div style="font-weight: bold; margin-bottom: 5px;">
                                ${icon} ${record.type}
                            </div>
                            <div style="font-size: 12px; color: #666;">
                                ${dateStr} Â· ${record.duration}åˆ†é’Ÿ
                                ${record.note ? ' Â· ' + record.note : ''}
                            </div>
                        </div>
                        <div class="training-badge">+${record.points}</div>
                    </div>
                `;
            }).join('');
        }

        function updateSportsStats() {
            if (!data.sports) {
                data.sports = {
                    badminton: { records: [], totalMinutes: 0, totalPoints: 0 },
                    outdoor: { records: [], totalMinutes: 0, totalPoints: 0 }
                };
            }

            // æ›´æ–°ç¾½æ¯›çƒç»Ÿè®¡
            const badmintonCount = data.sports.badminton.records.length;
            const badmintonHours = (data.sports.badminton.totalMinutes / 60).toFixed(1);
            document.getElementById('badmintonCount').textContent = badmintonCount;
            document.getElementById('badmintonHours').textContent = badmintonHours;

            // æ›´æ–°æˆ·å¤–æ´»åŠ¨ç»Ÿè®¡
            const outdoorCount = data.sports.outdoor.records.length;
            const outdoorHours = (data.sports.outdoor.totalMinutes / 60).toFixed(1);
            document.getElementById('outdoorCount').textContent = outdoorCount;
            document.getElementById('outdoorHours').textContent = outdoorHours;

            // æ›´æ–°æ€»ä½“ç»Ÿè®¡
            const totalTrainings = badmintonCount + outdoorCount;
            const totalMinutes = data.sports.badminton.totalMinutes + data.sports.outdoor.totalMinutes;
            const totalHours = (totalMinutes / 60).toFixed(1);
            const sportsPoints = data.sports.badminton.totalPoints + data.sports.outdoor.totalPoints;

            document.getElementById('totalTrainings').textContent = totalTrainings;
            document.getElementById('totalHours').textContent = totalHours + 'h';
            document.getElementById('sportsPoints').textContent = sportsPoints;
        }

        // å®¶åŠ¡åŠ³åŠ¨åŠŸèƒ½
        function completeChore(choreName, points) {
            if (!confirm(`ç¡®è®¤å®Œæˆ "${choreName}" äº†å—ï¼Ÿ`)) {
                return;
            }

            const now = new Date();
            const record = {
                id: Date.now(),
                name: choreName,
                points: points,
                date: now.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                })
            };

            data.chores.records.unshift(record);
            data.chores.totalCount++;

            // å°è¯•æ·»åŠ ç§¯åˆ†ï¼ˆæ¯æ—¥é™åˆ¶ï¼‰
            const earned = addPoints(points, `å®Œæˆå®¶åŠ¡: ${choreName}`, true);
            if (earned) {
                data.chores.totalPoints += points;
                showToast(`ğŸ‰ å¤ªæ£’äº†ï¼å®Œæˆ ${choreName}ï¼Œè·å¾— ${points} ç§¯åˆ†ï¼`);
            } else {
                showToast(`ğŸ“ å·²è®°å½• ${choreName}ï¼Œä½†ä»Šå¤©å·²è·å–è¿‡ç§¯åˆ†å•¦ï¼`);
            }

            saveData();
            renderChoreRecords();
            updateChoreStats();
            updatePointsDisplay();
            renderPointsHistory();

            // æ˜¾ç¤ºæˆåŠŸæç¤º
            showToast(`ğŸ‰ å¤ªæ£’äº†ï¼å®Œæˆ ${choreName}ï¼Œè·å¾— ${points} ç§¯åˆ†ï¼`);
        }

        function renderChoreRecords() {
            const container = document.getElementById('choreRecords');
            if (!container) return;

            if (data.chores.records.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.7); padding: 20px;">è¿˜æ²¡æœ‰å®Œæˆè¿‡å®¶åŠ¡å“¦ï¼Œå¼€å§‹åŠ³åŠ¨å§ï¼</p>';
                return;
            }

            // åªæ˜¾ç¤ºæœ€è¿‘10æ¡è®°å½•
            const recentRecords = data.chores.records.slice(0, 10);
            container.innerHTML = recentRecords.map(record => `
                <div class="chore-record-item">
                    <div class="chore-record-info">
                        <span class="chore-record-name">${record.name}</span>
                        <span class="chore-record-time">${record.date}</span>
                    </div>
                    <span class="chore-record-points">+${record.points} ç§¯åˆ†</span>
                </div>
            `).join('');
        }

        function updateChoreStats() {
            document.getElementById('choreCount').textContent = data.chores.totalCount || 0;
            document.getElementById('chorePoints').textContent = data.chores.totalPoints || 0;
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                color: white;
                padding: 15px 30px;
                border-radius: 30px;
                font-size: 16px;
                font-weight: bold;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 10000;
                animation: slideDown 0.3s, fadeOut 0.3s 2.7s;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);

            // æ·»åŠ åŠ¨ç”»æ ·å¼
            if (!document.getElementById('toast-style')) {
                const style = document.createElement('style');
                style.id = 'toast-style';
                style.textContent = `
                    @keyframes slideDown {
                        from { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                        to { transform: translateX(-50%) translateY(0); opacity: 1; }
                    }
                    @keyframes fadeOut {
                        from { opacity: 1; }
                        to { opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // æˆ·å¤–æ´»åŠ¨ç±»å‹é€‰æ‹©äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            const outdoorTypeSelect = document.getElementById('outdoorType');
            if (outdoorTypeSelect) {
                outdoorTypeSelect.addEventListener('change', function() {
                    const customInput = document.getElementById('outdoorCustom');
                    if (customInput) {
                        customInput.style.display = this.value === 'è‡ªå®šä¹‰' ? 'block' : 'none';
                    }
                });
            }
        });

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = init;
    </script>
</body>
</html>
